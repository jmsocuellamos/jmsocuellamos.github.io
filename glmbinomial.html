<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Unidad 12 GLM respuesta binomial | Modelos Estadísticos</title>
  <meta name="description" content="Unidad 12 GLM respuesta binomial | Modelos Estadísticos" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Unidad 12 GLM respuesta binomial | Modelos Estadísticos" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Unidad 12 GLM respuesta binomial | Modelos Estadísticos" />
  
  
  



<meta name="date" content="2022-02-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="glm.html"/>
<link rel="next" href="glmpoisson.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://sites.google.com/umh.es/statistical-models" target="blank">Modelos Estadísticos</a></li>
<li><a href="./">J. Morales y A.M. Mayoral</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introducción</a></li>
<li class="chapter" data-level="" data-path="antes-de-empezar.html"><a href="antes-de-empezar.html"><i class="fa fa-check"></i>Antes de empezar</a>
<ul>
<li class="chapter" data-level="" data-path="antes-de-empezar.html"><a href="antes-de-empezar.html#conceptos-básicos-del-diseño-experimental"><i class="fa fa-check"></i>Conceptos básicos del diseño experimental</a>
<ul>
<li class="chapter" data-level="" data-path="antes-de-empezar.html"><a href="antes-de-empezar.html#objetivo-del-diseño-experimental"><i class="fa fa-check"></i>Objetivo del diseño experimental</a></li>
<li class="chapter" data-level="" data-path="antes-de-empezar.html"><a href="antes-de-empezar.html#población-y-muestra"><i class="fa fa-check"></i>Población y muestra</a></li>
<li class="chapter" data-level="" data-path="antes-de-empezar.html"><a href="antes-de-empezar.html#medidas-y-escalas-de-medida"><i class="fa fa-check"></i>Medidas y escalas de medida</a></li>
<li class="chapter" data-level="" data-path="antes-de-empezar.html"><a href="antes-de-empezar.html#parámetros-poblacionales-y-estadísticos"><i class="fa fa-check"></i>Parámetros poblacionales y estadísticos</a></li>
</ul></li>
<li><a href="antes-de-empezar.html#primeros-pasos-con-r-y-rstudio">Primeros pasos con <code>R</code> y <code>RStudio</code></a>
<ul>
<li class="chapter" data-level="" data-path="antes-de-empezar.html"><a href="antes-de-empezar.html#instalación-y-puesta-en-marcha"><i class="fa fa-check"></i>Instalación y puesta en marcha</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="antes-de-empezar.html"><a href="antes-de-empezar.html#informes-prediseñados"><i class="fa fa-check"></i>Informes prediseñados</a></li>
<li><a href="antes-de-empezar.html#librerías-de-r-necesarías">Librerías de <code>R</code> necesarías</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introducción</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#conceptos-básicos"><i class="fa fa-check"></i><b>1.1</b> Conceptos básicos</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#objetivo-del-diseño-experimental-1"><i class="fa fa-check"></i><b>1.1.1</b> Objetivo del diseño experimental</a></li>
<li class="chapter" data-level="1.1.2" data-path="intro.html"><a href="intro.html#población-y-muestra-1"><i class="fa fa-check"></i><b>1.1.2</b> Población y muestra</a></li>
<li class="chapter" data-level="1.1.3" data-path="intro.html"><a href="intro.html#medidas-y-escalas-de-medida-1"><i class="fa fa-check"></i><b>1.1.3</b> Medidas y escalas de medida</a></li>
<li class="chapter" data-level="1.1.4" data-path="intro.html"><a href="intro.html#parámetros-poblacionales-y-estadísticos-1"><i class="fa fa-check"></i><b>1.1.4</b> Parámetros poblacionales y estadísticos</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#ejercicios"><i class="fa fa-check"></i><b>1.2</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="aed.html"><a href="aed.html"><i class="fa fa-check"></i><b>2</b> Análisis exploratorio de datos</a>
<ul>
<li class="chapter" data-level="2.1" data-path="aed.html"><a href="aed.html#objetivos"><i class="fa fa-check"></i><b>2.1</b> Objetivos</a></li>
<li class="chapter" data-level="2.2" data-path="aed.html"><a href="aed.html#variabilidad"><i class="fa fa-check"></i><b>2.2</b> Variabilidad</a></li>
<li class="chapter" data-level="2.3" data-path="aed.html"><a href="aed.html#procesado-inicial"><i class="fa fa-check"></i><b>2.3</b> Procesado inicial</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="aed.html"><a href="aed.html#operaciones-con-sujetos"><i class="fa fa-check"></i><b>2.3.1</b> Operaciones con sujetos</a></li>
<li class="chapter" data-level="2.3.2" data-path="aed.html"><a href="aed.html#trabajando-con-variables"><i class="fa fa-check"></i><b>2.3.2</b> Trabajando con variables</a></li>
<li class="chapter" data-level="2.3.3" data-path="aed.html"><a href="aed.html#reuniendo-los-datos"><i class="fa fa-check"></i><b>2.3.3</b> Reuniendo los datos</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="aed.html"><a href="aed.html#análisis-descriptivo-inicial"><i class="fa fa-check"></i><b>2.4</b> Análisis Descriptivo inicial</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="aed.html"><a href="aed.html#una-variable-factor"><i class="fa fa-check"></i><b>2.4.1</b> Una variable factor</a></li>
<li class="chapter" data-level="2.4.2" data-path="aed.html"><a href="aed.html#una-variable-numérica"><i class="fa fa-check"></i><b>2.4.2</b> Una variable numérica</a></li>
<li class="chapter" data-level="2.4.3" data-path="aed.html"><a href="aed.html#dos-variables-categóricas"><i class="fa fa-check"></i><b>2.4.3</b> Dos variables categóricas</a></li>
<li class="chapter" data-level="2.4.4" data-path="aed.html"><a href="aed.html#categórica-vs-numérica"><i class="fa fa-check"></i><b>2.4.4</b> Categórica vs Numérica</a></li>
<li class="chapter" data-level="2.4.5" data-path="aed.html"><a href="aed.html#dos-variables-numéricas"><i class="fa fa-check"></i><b>2.4.5</b> Dos variables numéricas</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="aed.html"><a href="aed.html#análisis-descriptivo-avanzado"><i class="fa fa-check"></i><b>2.5</b> Análisis Descriptivo avanzado</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="aed.html"><a href="aed.html#tres-factores"><i class="fa fa-check"></i><b>2.5.1</b> Tres factores</a></li>
<li class="chapter" data-level="2.5.2" data-path="aed.html"><a href="aed.html#dos-factores-una-numérica"><i class="fa fa-check"></i><b>2.5.2</b> Dos factores, Una numérica</a></li>
<li class="chapter" data-level="2.5.3" data-path="aed.html"><a href="aed.html#un-factor-dos-numéricas"><i class="fa fa-check"></i><b>2.5.3</b> Un factor, Dos numéricas</a></li>
<li class="chapter" data-level="2.5.4" data-path="aed.html"><a href="aed.html#dos-factores-dos-numéricas"><i class="fa fa-check"></i><b>2.5.4</b> Dos factores, Dos numéricas</a></li>
<li class="chapter" data-level="2.5.5" data-path="aed.html"><a href="aed.html#tres-factores-dos-numéricas"><i class="fa fa-check"></i><b>2.5.5</b> Tres factores, Dos numéricas</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="aed.html"><a href="aed.html#librería-de-interés"><i class="fa fa-check"></i><b>2.6</b> Librería de interés</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="prob.html"><a href="prob.html"><i class="fa fa-check"></i><b>3</b> Probabilidad</a>
<ul>
<li class="chapter" data-level="3.1" data-path="prob.html"><a href="prob.html#prob-intro"><i class="fa fa-check"></i><b>3.1</b> Introducción</a></li>
<li class="chapter" data-level="3.2" data-path="prob.html"><a href="prob.html#distribuciones-modelos"><i class="fa fa-check"></i><b>3.2</b> Distribuciones-Modelos</a></li>
<li class="chapter" data-level="3.3" data-path="prob.html"><a href="prob.html#distribuciones-notables"><i class="fa fa-check"></i><b>3.3</b> Distribuciones notables</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="prob.html"><a href="prob.html#prob-binomial"><i class="fa fa-check"></i><b>3.3.1</b> Distribución Binomial</a></li>
<li class="chapter" data-level="3.3.2" data-path="prob.html"><a href="prob.html#prob-poisson"><i class="fa fa-check"></i><b>3.3.2</b> Distribución Poisson</a></li>
<li class="chapter" data-level="3.3.3" data-path="prob.html"><a href="prob.html#prob-normal"><i class="fa fa-check"></i><b>3.3.3</b> Distribución Normal</a></li>
<li class="chapter" data-level="3.3.4" data-path="prob.html"><a href="prob.html#otras-distribuciones"><i class="fa fa-check"></i><b>3.3.4</b> Otras distribuciones</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="inferencia-básica.html"><a href="inferencia-básica.html"><i class="fa fa-check"></i><b>4</b> Inferencia básica</a>
<ul>
<li class="chapter" data-level="4.1" data-path="inferencia-básica.html"><a href="inferencia-básica.html#estimador-y-estimación"><i class="fa fa-check"></i><b>4.1</b> Estimador y estimación</a></li>
<li class="chapter" data-level="4.2" data-path="inferencia-básica.html"><a href="inferencia-básica.html#información-contenida-en-la-muestra"><i class="fa fa-check"></i><b>4.2</b> Información contenida en la muestra</a></li>
<li class="chapter" data-level="4.3" data-path="inferencia-básica.html"><a href="inferencia-básica.html#procedimientos-de-inferencia-estadística"><i class="fa fa-check"></i><b>4.3</b> Procedimientos de inferencia estadística</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="inferencia-básica.html"><a href="inferencia-básica.html#estimación-puntual"><i class="fa fa-check"></i><b>4.3.1</b> Estimación puntual</a></li>
<li class="chapter" data-level="4.3.2" data-path="inferencia-básica.html"><a href="inferencia-básica.html#distribución-en-el-muestreo"><i class="fa fa-check"></i><b>4.3.2</b> Distribución en el muestreo</a></li>
<li class="chapter" data-level="4.3.3" data-path="inferencia-básica.html"><a href="inferencia-básica.html#estimación-por-intervalos-de-confianza"><i class="fa fa-check"></i><b>4.3.3</b> Estimación por intervalos de confianza</a></li>
<li class="chapter" data-level="4.3.4" data-path="inferencia-básica.html"><a href="inferencia-básica.html#contraste-de-hipótesis"><i class="fa fa-check"></i><b>4.3.4</b> Contraste de hipótesis</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="inferencia-básica.html"><a href="inferencia-básica.html#inferencia-para-dos-poblaciones"><i class="fa fa-check"></i><b>4.4</b> Inferencia para dos poblaciones</a></li>
<li class="chapter" data-level="4.5" data-path="inferencia-básica.html"><a href="inferencia-básica.html#inferencia-para-dos-proporciones"><i class="fa fa-check"></i><b>4.5</b> Inferencia para dos proporciones</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="inferencia-básica.html"><a href="inferencia-básica.html#estimador-puntual"><i class="fa fa-check"></i><b>4.5.1</b> Estimador puntual</a></li>
<li class="chapter" data-level="4.5.2" data-path="inferencia-básica.html"><a href="inferencia-básica.html#estimador-por-intervalos-de-confianza"><i class="fa fa-check"></i><b>4.5.2</b> Estimador por intervalos de confianza</a></li>
<li class="chapter" data-level="4.5.3" data-path="inferencia-básica.html"><a href="inferencia-básica.html#contraste-de-hipótesis-1"><i class="fa fa-check"></i><b>4.5.3</b> Contraste de hipótesis</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="inferencia-básica.html"><a href="inferencia-básica.html#inferencia-para-dos-medias"><i class="fa fa-check"></i><b>4.6</b> Inferencia para dos medias</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="inferencia-básica.html"><a href="inferencia-básica.html#análisis-de-dos-varianzas-poblacionales"><i class="fa fa-check"></i><b>4.6.1</b> Análisis de dos varianzas poblacionales</a></li>
<li class="chapter" data-level="4.6.2" data-path="inferencia-básica.html"><a href="inferencia-básica.html#dos-medias-para-poblaciones-independientes-con-varianzas-iguales"><i class="fa fa-check"></i><b>4.6.2</b> Dos medias para poblaciones independientes con varianzas iguales</a></li>
<li class="chapter" data-level="4.6.3" data-path="inferencia-básica.html"><a href="inferencia-básica.html#dos-medias-para-poblaciones-independientes-con-varianzas-distintas"><i class="fa fa-check"></i><b>4.6.3</b> Dos medias para poblaciones independientes con varianzas distintas</a></li>
<li class="chapter" data-level="4.6.4" data-path="inferencia-básica.html"><a href="inferencia-básica.html#dos-medias-para-poblaciones-emparejadas"><i class="fa fa-check"></i><b>4.6.4</b> Dos medias para poblaciones emparejadas</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="inferencia-básica.html"><a href="inferencia-básica.html#procedimientos-no-paramétricos"><i class="fa fa-check"></i><b>4.7</b> Procedimientos no paramétricos</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="inferencia-básica.html"><a href="inferencia-básica.html#normalidad"><i class="fa fa-check"></i><b>4.7.1</b> Normalidad</a></li>
<li class="chapter" data-level="4.7.2" data-path="inferencia-básica.html"><a href="inferencia-básica.html#dos-medianas-en-poblaciones-independientes"><i class="fa fa-check"></i><b>4.7.2</b> Dos medianas en poblaciones independientes</a></li>
<li class="chapter" data-level="4.7.3" data-path="inferencia-básica.html"><a href="inferencia-básica.html#dos-medianas-en-poblaciones-dependientes"><i class="fa fa-check"></i><b>4.7.3</b> Dos medianas en poblaciones dependientes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="modelstats.html"><a href="modelstats.html"><i class="fa fa-check"></i><b>5</b> Modelos estadísticos</a>
<ul>
<li class="chapter" data-level="5.1" data-path="modelstats.html"><a href="modelstats.html#componentes-del-modelo"><i class="fa fa-check"></i><b>5.1</b> Componentes del modelo</a></li>
<li class="chapter" data-level="5.2" data-path="modelstats.html"><a href="modelstats.html#tipos-de-modelos"><i class="fa fa-check"></i><b>5.2</b> Tipos de modelos</a></li>
<li class="chapter" data-level="5.3" data-path="modelstats.html"><a href="modelstats.html#fases-en-la-construcción-de-un-modelo"><i class="fa fa-check"></i><b>5.3</b> Fases en la construcción de un modelo</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="rls.html"><a href="rls.html"><i class="fa fa-check"></i><b>6</b> Regresión Lineal Simple (RLS)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="rls.html"><a href="rls.html#bancos-de-datos"><i class="fa fa-check"></i><b>6.1</b> Bancos de datos</a></li>
<li class="chapter" data-level="6.2" data-path="rls.html"><a href="rls.html#modelorls"><i class="fa fa-check"></i><b>6.2</b> El modelo RLS</a></li>
<li class="chapter" data-level="6.3" data-path="rls.html"><a href="rls.html#estimacionrls"><i class="fa fa-check"></i><b>6.3</b> Estimación del modelo</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="rls.html"><a href="rls.html#mincuadrls"><i class="fa fa-check"></i><b>6.3.1</b> Estimación Mínimos Cuadrados</a></li>
<li class="chapter" data-level="6.3.2" data-path="rls.html"><a href="rls.html#emvrls"><i class="fa fa-check"></i><b>6.3.2</b> Estimación Máximo Verosímil</a></li>
<li class="chapter" data-level="6.3.3" data-path="rls.html"><a href="rls.html#emR"><i class="fa fa-check"></i><b>6.3.3</b> Estimación con R</a></li>
<li class="chapter" data-level="6.3.4" data-path="rls.html"><a href="rls.html#ejemplos"><i class="fa fa-check"></i><b>6.3.4</b> Ejemplos</a></li>
<li class="chapter" data-level="6.3.5" data-path="rls.html"><a href="rls.html#propiedades-de-la-recta-de-regresión."><i class="fa fa-check"></i><b>6.3.5</b> Propiedades de la recta de regresión.</a></li>
<li class="chapter" data-level="6.3.6" data-path="rls.html"><a href="rls.html#rls_varmodel"><i class="fa fa-check"></i><b>6.3.6</b> Estimación varianza del modelo.</a></li>
<li class="chapter" data-level="6.3.7" data-path="rls.html"><a href="rls.html#inferencia-sobre-los-coeficientes-del-modelo"><i class="fa fa-check"></i><b>6.3.7</b> Inferencia sobre los coeficientes del modelo</a></li>
<li class="chapter" data-level="6.3.8" data-path="rls.html"><a href="rls.html#ejemplo"><i class="fa fa-check"></i><b>6.3.8</b> Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="rls.html"><a href="rls.html#bondad-del-ajuste"><i class="fa fa-check"></i><b>6.4</b> Bondad del Ajuste</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="rls.html"><a href="rls.html#rls_errorresidual"><i class="fa fa-check"></i><b>6.4.1</b> Error residual</a></li>
<li class="chapter" data-level="6.4.2" data-path="rls.html"><a href="rls.html#rls_tablaanova"><i class="fa fa-check"></i><b>6.4.2</b> Tabla Anova</a></li>
<li class="chapter" data-level="6.4.3" data-path="rls.html"><a href="rls.html#coeficiente-de-determinación"><i class="fa fa-check"></i><b>6.4.3</b> Coeficiente de determinación</a></li>
<li class="chapter" data-level="6.4.4" data-path="rls.html"><a href="rls.html#ejemplo-1"><i class="fa fa-check"></i><b>6.4.4</b> Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="rls.html"><a href="rls.html#rls_diag"><i class="fa fa-check"></i><b>6.5</b> Diagnóstico del Modelo</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="rls.html"><a href="rls.html#linealidad-y-homocedasticidad."><i class="fa fa-check"></i><b>6.5.1</b> Linealidad y homocedasticidad.</a></li>
<li class="chapter" data-level="6.5.2" data-path="rls.html"><a href="rls.html#ejemplo-2"><i class="fa fa-check"></i><b>6.5.2</b> Ejemplo</a></li>
<li class="chapter" data-level="6.5.3" data-path="rls.html"><a href="rls.html#normalidad-1"><i class="fa fa-check"></i><b>6.5.3</b> Normalidad</a></li>
<li class="chapter" data-level="6.5.4" data-path="rls.html"><a href="rls.html#independencia."><i class="fa fa-check"></i><b>6.5.4</b> Independencia.</a></li>
<li class="chapter" data-level="6.5.5" data-path="rls.html"><a href="rls.html#otros-gráficos-de-diagnóstico"><i class="fa fa-check"></i><b>6.5.5</b> Otros gráficos de diagnóstico</a></li>
<li class="chapter" data-level="6.5.6" data-path="rls.html"><a href="rls.html#incumplimiento-de-hipótesis"><i class="fa fa-check"></i><b>6.5.6</b> Incumplimiento de hipótesis</a></li>
<li class="chapter" data-level="6.5.7" data-path="rls.html"><a href="rls.html#análisis-de-influencia"><i class="fa fa-check"></i><b>6.5.7</b> Análisis de influencia</a></li>
<li class="chapter" data-level="6.5.8" data-path="rls.html"><a href="rls.html#transformaciones"><i class="fa fa-check"></i><b>6.5.8</b> Transformaciones</a></li>
<li class="chapter" data-level="6.5.9" data-path="rls.html"><a href="rls.html#ejemplos-1"><i class="fa fa-check"></i><b>6.5.9</b> Ejemplos</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="rls.html"><a href="rls.html#rls_pred"><i class="fa fa-check"></i><b>6.6</b> Predicción del modelo</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="rls.html"><a href="rls.html#respuesta-media"><i class="fa fa-check"></i><b>6.6.1</b> Respuesta media</a></li>
<li class="chapter" data-level="6.6.2" data-path="rls.html"><a href="rls.html#nueva-observación"><i class="fa fa-check"></i><b>6.6.2</b> Nueva observación</a></li>
<li class="chapter" data-level="6.6.3" data-path="rls.html"><a href="rls.html#ejemplos-2"><i class="fa fa-check"></i><b>6.6.3</b> Ejemplos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="rlm.html"><a href="rlm.html"><i class="fa fa-check"></i><b>7</b> Regresión Lineal Múltiple y Polinómica</a>
<ul>
<li class="chapter" data-level="7.1" data-path="rlm.html"><a href="rlm.html#tipos-de-modelos-1"><i class="fa fa-check"></i><b>7.1</b> Tipos de modelos</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="rlm.html"><a href="rlm.html#modelos-de-rlm"><i class="fa fa-check"></i><b>7.1.1</b> Modelos de RLM</a></li>
<li class="chapter" data-level="7.1.2" data-path="rlm.html"><a href="rlm.html#modelos-de-rp"><i class="fa fa-check"></i><b>7.1.2</b> Modelos de RP</a></li>
<li class="chapter" data-level="7.1.3" data-path="rlm.html"><a href="rlm.html#expresión-en-r-de-los-modelos"><i class="fa fa-check"></i><b>7.1.3</b> Expresión en R de los modelos</a></li>
<li class="chapter" data-level="7.1.4" data-path="rlm.html"><a href="rlm.html#modelo-saturado-y-anidado"><i class="fa fa-check"></i><b>7.1.4</b> Modelo saturado y anidado</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="rlm.html"><a href="rlm.html#estimación-e-inferencia"><i class="fa fa-check"></i><b>7.2</b> Estimación e inferencia</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="rlm.html"><a href="rlm.html#mínimos-cuadrados"><i class="fa fa-check"></i><b>7.2.1</b> Mínimos cuadrados</a></li>
<li class="chapter" data-level="7.2.2" data-path="rlm.html"><a href="rlm.html#propiedades"><i class="fa fa-check"></i><b>7.2.2</b> Propiedades</a></li>
<li class="chapter" data-level="7.2.3" data-path="rlm.html"><a href="rlm.html#máxima-verosimilitud"><i class="fa fa-check"></i><b>7.2.3</b> Máxima verosimilitud</a></li>
<li class="chapter" data-level="7.2.4" data-path="rlm.html"><a href="rlm.html#inferencia"><i class="fa fa-check"></i><b>7.2.4</b> Inferencia</a></li>
<li class="chapter" data-level="7.2.5" data-path="rlm.html"><a href="rlm.html#ejemplos-3"><i class="fa fa-check"></i><b>7.2.5</b> Ejemplos</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="rlm.html"><a href="rlm.html#bondad-del-ajuste-1"><i class="fa fa-check"></i><b>7.3</b> Bondad del ajuste</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="rlm.html"><a href="rlm.html#tabla-anova"><i class="fa fa-check"></i><b>7.3.1</b> Tabla ANOVA</a></li>
<li class="chapter" data-level="7.3.2" data-path="rlm.html"><a href="rlm.html#coeficiente-determinación"><i class="fa fa-check"></i><b>7.3.2</b> Coeficiente determinación</a></li>
<li class="chapter" data-level="7.3.3" data-path="rlm.html"><a href="rlm.html#ejemplos-4"><i class="fa fa-check"></i><b>7.3.3</b> Ejemplos</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="rlm.html"><a href="rlm.html#comparación-y-selección-de-modelos"><i class="fa fa-check"></i><b>7.4</b> Comparación y selección de modelos</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="rlm.html"><a href="rlm.html#significatividad-de-los-predictores"><i class="fa fa-check"></i><b>7.4.1</b> Significatividad de los predictores</a></li>
<li class="chapter" data-level="7.4.2" data-path="rlm.html"><a href="rlm.html#estadísticos-aic-y-bic"><i class="fa fa-check"></i><b>7.4.2</b> Estadísticos AIC y BIC</a></li>
<li class="chapter" data-level="7.4.3" data-path="rlm.html"><a href="rlm.html#selección-automática"><i class="fa fa-check"></i><b>7.4.3</b> Selección automática</a></li>
<li class="chapter" data-level="7.4.4" data-path="rlm.html"><a href="rlm.html#funciones-en-r"><i class="fa fa-check"></i><b>7.4.4</b> Funciones en R</a></li>
<li class="chapter" data-level="7.4.5" data-path="rlm.html"><a href="rlm.html#ejemplos-5"><i class="fa fa-check"></i><b>7.4.5</b> Ejemplos</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="rlm.html"><a href="rlm.html#multicolinealidad"><i class="fa fa-check"></i><b>7.5</b> Multicolinealidad</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="rlm.html"><a href="rlm.html#causas"><i class="fa fa-check"></i><b>7.5.1</b> Causas</a></li>
<li class="chapter" data-level="7.5.2" data-path="rlm.html"><a href="rlm.html#efectos"><i class="fa fa-check"></i><b>7.5.2</b> Efectos</a></li>
<li class="chapter" data-level="7.5.3" data-path="rlm.html"><a href="rlm.html#diagnósticos"><i class="fa fa-check"></i><b>7.5.3</b> Diagnósticos</a></li>
<li class="chapter" data-level="7.5.4" data-path="rlm.html"><a href="rlm.html#soluciones"><i class="fa fa-check"></i><b>7.5.4</b> Soluciones</a></li>
<li class="chapter" data-level="7.5.5" data-path="rlm.html"><a href="rlm.html#ejemplos-6"><i class="fa fa-check"></i><b>7.5.5</b> Ejemplos</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="rlm.html"><a href="rlm.html#diagnóstico"><i class="fa fa-check"></i><b>7.6</b> Diagnóstico</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="rlm.html"><a href="rlm.html#tipos-de-residuos"><i class="fa fa-check"></i><b>7.6.1</b> Tipos de Residuos</a></li>
<li class="chapter" data-level="7.6.2" data-path="rlm.html"><a href="rlm.html#linealidad"><i class="fa fa-check"></i><b>7.6.2</b> Linealidad</a></li>
<li class="chapter" data-level="7.6.3" data-path="rlm.html"><a href="rlm.html#homocedasticidad"><i class="fa fa-check"></i><b>7.6.3</b> Homocedasticidad</a></li>
<li class="chapter" data-level="7.6.4" data-path="rlm.html"><a href="rlm.html#normalidad-2"><i class="fa fa-check"></i><b>7.6.4</b> Normalidad</a></li>
<li class="chapter" data-level="7.6.5" data-path="rlm.html"><a href="rlm.html#incorrelación"><i class="fa fa-check"></i><b>7.6.5</b> Incorrelación</a></li>
<li class="chapter" data-level="7.6.6" data-path="rlm.html"><a href="rlm.html#soluciones-a-problemas-detectados-en-el-diagnóstico-del-modelo"><i class="fa fa-check"></i><b>7.6.6</b> Soluciones a problemas detectados en el diagnóstico del modelo</a></li>
<li class="chapter" data-level="7.6.7" data-path="rlm.html"><a href="rlm.html#análisis-de-influencia-1"><i class="fa fa-check"></i><b>7.6.7</b> Análisis de influencia</a></li>
<li class="chapter" data-level="7.6.8" data-path="rlm.html"><a href="rlm.html#funciones-para-diagnóstico-e-influencia"><i class="fa fa-check"></i><b>7.6.8</b> Funciones para diagnóstico e influencia</a></li>
<li class="chapter" data-level="7.6.9" data-path="rlm.html"><a href="rlm.html#ejemplos-7"><i class="fa fa-check"></i><b>7.6.9</b> Ejemplos</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="rlm.html"><a href="rlm.html#predicción"><i class="fa fa-check"></i><b>7.7</b> Predicción</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="rlm.html"><a href="rlm.html#estimación-de-la-respuesta-media."><i class="fa fa-check"></i><b>7.7.1</b> Estimación de la respuesta media.</a></li>
<li class="chapter" data-level="7.7.2" data-path="rlm.html"><a href="rlm.html#predicción-de-nuevas-observaciones."><i class="fa fa-check"></i><b>7.7.2</b> Predicción de nuevas observaciones.</a></li>
<li class="chapter" data-level="7.7.3" data-path="rlm.html"><a href="rlm.html#ejemplos-8"><i class="fa fa-check"></i><b>7.7.3</b> Ejemplos</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="rlm.html"><a href="rlm.html#ejercicios-1"><i class="fa fa-check"></i><b>7.8</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>8</b> Modelos ANOVA</a>
<ul>
<li class="chapter" data-level="8.1" data-path="anova.html"><a href="anova.html#bancos-de-datos-1"><i class="fa fa-check"></i><b>8.1</b> Bancos de datos</a></li>
<li class="chapter" data-level="8.2" data-path="anova.html"><a href="anova.html#modelos-anova-1-vía"><i class="fa fa-check"></i><b>8.2</b> Modelos ANOVA 1 vía</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="anova.html"><a href="anova.html#especificacion-del-modelo-en-r"><i class="fa fa-check"></i><b>8.2.1</b> Especificacion del modelo en <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="anova.html"><a href="anova.html#modelos-anova-dos-vías"><i class="fa fa-check"></i><b>8.3</b> Modelos ANOVA dos vías</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="anova.html"><a href="anova.html#especificacion-del-modelo-en-r-1"><i class="fa fa-check"></i><b>8.3.1</b> Especificacion del modelo en <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="anova.html"><a href="anova.html#estimación-y-bondad-de-ajuste-del-modelo"><i class="fa fa-check"></i><b>8.4</b> Estimación y bondad de ajuste del modelo</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="anova.html"><a href="anova.html#ejemplos-9"><i class="fa fa-check"></i><b>8.4.1</b> Ejemplos</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="anova.html"><a href="anova.html#comparación-y-selección-de-modelos-1"><i class="fa fa-check"></i><b>8.5</b> Comparación y selección de modelos</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="anova.html"><a href="anova.html#ejemplos-10"><i class="fa fa-check"></i><b>8.5.1</b> Ejemplos</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="anova.html"><a href="anova.html#diagnóstico-1"><i class="fa fa-check"></i><b>8.6</b> Diagnóstico</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="anova.html"><a href="anova.html#ejemplos-11"><i class="fa fa-check"></i><b>8.6.1</b> Ejemplos</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="anova.html"><a href="anova.html#predicción-1"><i class="fa fa-check"></i><b>8.7</b> Predicción</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="anova.html"><a href="anova.html#ejemplos-12"><i class="fa fa-check"></i><b>8.7.1</b> Ejemplos</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="anova.html"><a href="anova.html#ejercicios-2"><i class="fa fa-check"></i><b>8.8</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ancova.html"><a href="ancova.html"><i class="fa fa-check"></i><b>9</b> Modelos ANCOVA</a>
<ul>
<li class="chapter" data-level="9.1" data-path="ancova.html"><a href="ancova.html#bancos-de-datos-2"><i class="fa fa-check"></i><b>9.1</b> Bancos de datos</a></li>
<li class="chapter" data-level="9.2" data-path="ancova.html"><a href="ancova.html#modelo-ancova-básico"><i class="fa fa-check"></i><b>9.2</b> Modelo ANCOVA básico</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="ancova.html"><a href="ancova.html#i-rectas-de-regresión-perpendiculares"><i class="fa fa-check"></i><b>9.2.1</b> I rectas de regresión perpendiculares</a></li>
<li class="chapter" data-level="9.2.2" data-path="ancova.html"><a href="ancova.html#i-rectas-de-regresión-paralelas"><i class="fa fa-check"></i><b>9.2.2</b> I rectas de regresión paralelas</a></li>
<li class="chapter" data-level="9.2.3" data-path="ancova.html"><a href="ancova.html#una-recta-de-regresión"><i class="fa fa-check"></i><b>9.2.3</b> Una recta de regresión</a></li>
<li class="chapter" data-level="9.2.4" data-path="ancova.html"><a href="ancova.html#anova-de-una-vía"><i class="fa fa-check"></i><b>9.2.4</b> ANOVA de una vía</a></li>
<li class="chapter" data-level="9.2.5" data-path="ancova.html"><a href="ancova.html#modelos-sin-efectos"><i class="fa fa-check"></i><b>9.2.5</b> Modelos sin efectos</a></li>
<li class="chapter" data-level="9.2.6" data-path="ancova.html"><a href="ancova.html#especificación-del-modelo-en-r"><i class="fa fa-check"></i><b>9.2.6</b> Especificación del modelo en <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="ancova.html"><a href="ancova.html#análisis-preliminar"><i class="fa fa-check"></i><b>9.3</b> Análisis preliminar</a></li>
<li class="chapter" data-level="9.4" data-path="ancova.html"><a href="ancova.html#ajuste-y-selección-del-modelo"><i class="fa fa-check"></i><b>9.4</b> Ajuste y Selección del modelo</a></li>
<li class="chapter" data-level="9.5" data-path="ancova.html"><a href="ancova.html#diagnóstico-del-modelo"><i class="fa fa-check"></i><b>9.5</b> Diagnóstico del modelo</a></li>
<li class="chapter" data-level="9.6" data-path="ancova.html"><a href="ancova.html#predicción-2"><i class="fa fa-check"></i><b>9.6</b> Predicción</a></li>
<li class="chapter" data-level="9.7" data-path="ancova.html"><a href="ancova.html#ejercicios-modelos-ancova"><i class="fa fa-check"></i><b>9.7</b> Ejercicios modelos ANCOVA</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="smooth.html"><a href="smooth.html"><i class="fa fa-check"></i><b>10</b> Modelos aditivos lineales</a>
<ul>
<li class="chapter" data-level="10.1" data-path="smooth.html"><a href="smooth.html#bancos-de-datos-3"><i class="fa fa-check"></i><b>10.1</b> Bancos de datos</a></li>
<li class="chapter" data-level="10.2" data-path="smooth.html"><a href="smooth.html#funciones-de-suavizado"><i class="fa fa-check"></i><b>10.2</b> Funciones de suavizado</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="smooth.html"><a href="smooth.html#splines-de-regresión"><i class="fa fa-check"></i><b>10.2.1</b> Splines de regresión</a></li>
<li class="chapter" data-level="10.2.2" data-path="smooth.html"><a href="smooth.html#splines-cúbicos"><i class="fa fa-check"></i><b>10.2.2</b> Splines cúbicos</a></li>
<li class="chapter" data-level="10.2.3" data-path="smooth.html"><a href="smooth.html#splines-penalizados"><i class="fa fa-check"></i><b>10.2.3</b> Splines penalizados</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="smooth.html"><a href="smooth.html#bondad-del-ajuste-y-selección-del-modelo"><i class="fa fa-check"></i><b>10.3</b> Bondad del ajuste y selección del modelo</a></li>
<li class="chapter" data-level="10.4" data-path="smooth.html"><a href="smooth.html#diagnóstico-2"><i class="fa fa-check"></i><b>10.4</b> Diagnóstico</a></li>
<li class="chapter" data-level="10.5" data-path="smooth.html"><a href="smooth.html#predicción-3"><i class="fa fa-check"></i><b>10.5</b> Predicción</a></li>
<li class="chapter" data-level="10.6" data-path="smooth.html"><a href="smooth.html#ejercicios-3"><i class="fa fa-check"></i><b>10.6</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>11</b> Modelos Lineales Generalizados</a>
<ul>
<li class="chapter" data-level="11.1" data-path="glm.html"><a href="glm.html#modelo-teórico"><i class="fa fa-check"></i><b>11.1</b> Modelo Teórico</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="glm.html"><a href="glm.html#distribución-binomial-logit-link"><i class="fa fa-check"></i><b>11.1.1</b> Distribución Binomial (logit link)</a></li>
<li class="chapter" data-level="11.1.2" data-path="glm.html"><a href="glm.html#distribución-poisson-log-link"><i class="fa fa-check"></i><b>11.1.2</b> Distribución Poisson (log link)</a></li>
<li class="chapter" data-level="11.1.3" data-path="glm.html"><a href="glm.html#distribución-normal-link-identidad"><i class="fa fa-check"></i><b>11.1.3</b> Distribución Normal (link identidad)</a></li>
<li class="chapter" data-level="11.1.4" data-path="glm.html"><a href="glm.html#distribución-gamma-link-recíproco"><i class="fa fa-check"></i><b>11.1.4</b> Distribución Gamma (link recíproco)</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="glm.html"><a href="glm.html#estimación-de-los-glm"><i class="fa fa-check"></i><b>11.2</b> Estimación de los GLM</a></li>
<li class="chapter" data-level="11.3" data-path="glm.html"><a href="glm.html#bondad-del-ajuste-2"><i class="fa fa-check"></i><b>11.3</b> Bondad del ajuste</a></li>
<li class="chapter" data-level="11.4" data-path="glm.html"><a href="glm.html#comparación-de-modelos"><i class="fa fa-check"></i><b>11.4</b> Comparación de modelos</a></li>
<li class="chapter" data-level="11.5" data-path="glm.html"><a href="glm.html#diagnóstico-de-los-glm"><i class="fa fa-check"></i><b>11.5</b> Diagnóstico de los GLM</a></li>
<li class="chapter" data-level="11.6" data-path="glm.html"><a href="glm.html#predicción-de-los-glm"><i class="fa fa-check"></i><b>11.6</b> Predicción de los GLM</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="glmbinomial.html"><a href="glmbinomial.html"><i class="fa fa-check"></i><b>12</b> GLM respuesta binomial</a>
<ul>
<li class="chapter" data-level="12.1" data-path="glmbinomial.html"><a href="glmbinomial.html#tipos-de-datos-binomiales"><i class="fa fa-check"></i><b>12.1</b> Tipos de datos binomiales</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="glmbinomial.html"><a href="glmbinomial.html#información-individualizada-por-sujeto"><i class="fa fa-check"></i><b>12.1.1</b> Información individualizada por sujeto</a></li>
<li class="chapter" data-level="12.1.2" data-path="glmbinomial.html"><a href="glmbinomial.html#información-agrupada-por-sujetos"><i class="fa fa-check"></i><b>12.1.2</b> Información agrupada por sujetos</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="glmbinomial.html"><a href="glmbinomial.html#especificación-e-hipótesis-de-modelo"><i class="fa fa-check"></i><b>12.2</b> Especificación e hipótesis de modelo</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="glmbinomial.html"><a href="glmbinomial.html#funciones-link"><i class="fa fa-check"></i><b>12.2.1</b> Funciones link</a></li>
<li class="chapter" data-level="12.2.2" data-path="glmbinomial.html"><a href="glmbinomial.html#representación-de-las-funciones-link"><i class="fa fa-check"></i><b>12.2.2</b> Representación de las funciones link</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="glmbinomial.html"><a href="glmbinomial.html#estimación-y-bondad-de-ajuste"><i class="fa fa-check"></i><b>12.3</b> Estimación y bondad de ajuste</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="glmbinomial.html"><a href="glmbinomial.html#ejemplos-13"><i class="fa fa-check"></i><b>12.3.1</b> Ejemplos</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="glmbinomial.html"><a href="glmbinomial.html#selección-del-modelo"><i class="fa fa-check"></i><b>12.4</b> Selección del modelo</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="glmbinomial.html"><a href="glmbinomial.html#ejemplos-14"><i class="fa fa-check"></i><b>12.4.1</b> Ejemplos</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="glmbinomial.html"><a href="glmbinomial.html#diagnóstico-3"><i class="fa fa-check"></i><b>12.5</b> Diagnóstico</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="glmbinomial.html"><a href="glmbinomial.html#ejemplos-15"><i class="fa fa-check"></i><b>12.5.1</b> Ejemplos</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="glmbinomial.html"><a href="glmbinomial.html#predicción-4"><i class="fa fa-check"></i><b>12.6</b> Predicción</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="glmbinomial.html"><a href="glmbinomial.html#ejemplos-16"><i class="fa fa-check"></i><b>12.6.1</b> Ejemplos</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="glmbinomial.html"><a href="glmbinomial.html#ejercicios-4"><i class="fa fa-check"></i><b>12.7</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="glmpoisson.html"><a href="glmpoisson.html"><i class="fa fa-check"></i><b>13</b> GLM Poisson</a>
<ul>
<li class="chapter" data-level="13.1" data-path="glmpoisson.html"><a href="glmpoisson.html#bancos-de-datos-4"><i class="fa fa-check"></i><b>13.1</b> Bancos de datos</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="glmpoisson.html"><a href="glmpoisson.html#telas"><i class="fa fa-check"></i><b>13.1.1</b> Telas</a></li>
<li class="chapter" data-level="13.1.2" data-path="glmpoisson.html"><a href="glmpoisson.html#barcos"><i class="fa fa-check"></i><b>13.1.2</b> Barcos</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="glmpoisson.html"><a href="glmpoisson.html#modelo-teórico-1"><i class="fa fa-check"></i><b>13.2</b> Modelo Teórico</a></li>
<li class="chapter" data-level="13.3" data-path="glmpoisson.html"><a href="glmpoisson.html#estimación-y-bondad-de-ajuste-del-modelo-1"><i class="fa fa-check"></i><b>13.3</b> Estimación y bondad de ajuste del modelo</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="glmpoisson.html"><a href="glmpoisson.html#ejemplos-17"><i class="fa fa-check"></i><b>13.3.1</b> Ejemplos</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="glmpoisson.html"><a href="glmpoisson.html#selección-del-modelo-1"><i class="fa fa-check"></i><b>13.4</b> Selección del modelo</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="glmpoisson.html"><a href="glmpoisson.html#ejemplos-18"><i class="fa fa-check"></i><b>13.4.1</b> Ejemplos</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="glmpoisson.html"><a href="glmpoisson.html#diagnóstico-4"><i class="fa fa-check"></i><b>13.5</b> Diagnóstico</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="glmpoisson.html"><a href="glmpoisson.html#ejemplos-19"><i class="fa fa-check"></i><b>13.5.1</b> Ejemplos</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="glmpoisson.html"><a href="glmpoisson.html#predicción-5"><i class="fa fa-check"></i><b>13.6</b> Predicción</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="glmpoisson.html"><a href="glmpoisson.html#bancos-de-datos-5"><i class="fa fa-check"></i><b>13.6.1</b> Bancos de datos</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="glmpoisson.html"><a href="glmpoisson.html#ejercicios-5"><i class="fa fa-check"></i><b>13.7</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="glmtablascont.html"><a href="glmtablascont.html"><i class="fa fa-check"></i><b>14</b> GLM para tablas de contingencia</a>
<ul>
<li class="chapter" data-level="14.1" data-path="glmtablascont.html"><a href="glmtablascont.html#bancos-de-datos-6"><i class="fa fa-check"></i><b>14.1</b> Bancos de datos</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="glmtablascont.html"><a href="glmtablascont.html#melanoma"><i class="fa fa-check"></i><b>14.1.1</b> Melanoma</a></li>
<li class="chapter" data-level="14.1.2" data-path="glmtablascont.html"><a href="glmtablascont.html#gripe"><i class="fa fa-check"></i><b>14.1.2</b> Gripe</a></li>
<li class="chapter" data-level="14.1.3" data-path="glmtablascont.html"><a href="glmtablascont.html#aspirina"><i class="fa fa-check"></i><b>14.1.3</b> Aspirina</a></li>
<li class="chapter" data-level="14.1.4" data-path="glmtablascont.html"><a href="glmtablascont.html#aspiraciones"><i class="fa fa-check"></i><b>14.1.4</b> Aspiraciones</a></li>
<li class="chapter" data-level="14.1.5" data-path="glmtablascont.html"><a href="glmtablascont.html#contraceptivos"><i class="fa fa-check"></i><b>14.1.5</b> Contraceptivos</a></li>
<li class="chapter" data-level="14.1.6" data-path="glmtablascont.html"><a href="glmtablascont.html#satisfacción-laboral"><i class="fa fa-check"></i><b>14.1.6</b> Satisfacción laboral</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="glmtablascont.html"><a href="glmtablascont.html#modelos-log-lineales"><i class="fa fa-check"></i><b>14.2</b> Modelos Log-Lineales</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="glmtablascont.html"><a href="glmtablascont.html#especificación-en-r"><i class="fa fa-check"></i><b>14.2.1</b> Especificación en R</a></li>
<li class="chapter" data-level="14.2.2" data-path="glmtablascont.html"><a href="glmtablascont.html#ejemplos-20"><i class="fa fa-check"></i><b>14.2.2</b> Ejemplos</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="glmtablascont.html"><a href="glmtablascont.html#modelos-logit-multinomial"><i class="fa fa-check"></i><b>14.3</b> Modelos Logit-Multinomial</a></li>
<li class="chapter" data-level="14.4" data-path="glmtablascont.html"><a href="glmtablascont.html#estimación"><i class="fa fa-check"></i><b>14.4</b> Estimación</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="glmtablascont.html"><a href="glmtablascont.html#respuesta-binaria-nominal-y-predictora-nominal"><i class="fa fa-check"></i><b>14.4.1</b> Respuesta binaria nominal y predictora nominal</a></li>
<li class="chapter" data-level="14.4.2" data-path="glmtablascont.html"><a href="glmtablascont.html#respuesta-multinomial-nominal-y-predictora-nominal"><i class="fa fa-check"></i><b>14.4.2</b> Respuesta multinomial nominal y predictora nominal</a></li>
<li class="chapter" data-level="14.4.3" data-path="glmtablascont.html"><a href="glmtablascont.html#respuesta-nominal-predictora-ordinal"><i class="fa fa-check"></i><b>14.4.3</b> Respuesta nominal, predictora ordinal</a></li>
<li class="chapter" data-level="14.4.4" data-path="glmtablascont.html"><a href="glmtablascont.html#respuesta-ordinal-predictora-nominal"><i class="fa fa-check"></i><b>14.4.4</b> Respuesta ordinal, predictora nominal</a></li>
<li class="chapter" data-level="14.4.5" data-path="glmtablascont.html"><a href="glmtablascont.html#respuesta-ordinal-predictora-ordinal"><i class="fa fa-check"></i><b>14.4.5</b> Respuesta ordinal, predictora ordinal</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="glmtablascont.html"><a href="glmtablascont.html#diagnóstico-5"><i class="fa fa-check"></i><b>14.5</b> Diagnóstico</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="glmtablascont.html"><a href="glmtablascont.html#ejemplos-21"><i class="fa fa-check"></i><b>14.5.1</b> Ejemplos</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="glmtablascont.html"><a href="glmtablascont.html#predicción-6"><i class="fa fa-check"></i><b>14.6</b> Predicción</a></li>
<li class="chapter" data-level="14.7" data-path="glmtablascont.html"><a href="glmtablascont.html#ejercicios-6"><i class="fa fa-check"></i><b>14.7</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="glmsuperv.html"><a href="glmsuperv.html"><i class="fa fa-check"></i><b>15</b> GLM para datos de supervivencia</a>
<ul>
<li class="chapter" data-level="15.1" data-path="glmsuperv.html"><a href="glmsuperv.html#funciones-de-supervivencia"><i class="fa fa-check"></i><b>15.1</b> Funciones de supervivencia</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="glmsuperv.html"><a href="glmsuperv.html#supervivencia-completa"><i class="fa fa-check"></i><b>15.1.1</b> Supervivencia completa</a></li>
<li class="chapter" data-level="15.1.2" data-path="glmsuperv.html"><a href="glmsuperv.html#supervivencia-por-un-factor"><i class="fa fa-check"></i><b>15.1.2</b> Supervivencia por un factor</a></li>
<li class="chapter" data-level="15.1.3" data-path="glmsuperv.html"><a href="glmsuperv.html#test-de-comparación"><i class="fa fa-check"></i><b>15.1.3</b> Test de comparación</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="glmsuperv.html"><a href="glmsuperv.html#análisis-preliminar-1"><i class="fa fa-check"></i><b>15.2</b> Análisis preliminar</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="glmsuperv.html"><a href="glmsuperv.html#leucemia"><i class="fa fa-check"></i><b>15.2.1</b> Leucemia</a></li>
<li class="chapter" data-level="15.2.2" data-path="glmsuperv.html"><a href="glmsuperv.html#veteranos"><i class="fa fa-check"></i><b>15.2.2</b> Veteranos</a></li>
<li class="chapter" data-level="15.2.3" data-path="glmsuperv.html"><a href="glmsuperv.html#cáncer-de-pulmón"><i class="fa fa-check"></i><b>15.2.3</b> Cáncer de pulmón</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="glmsuperv.html"><a href="glmsuperv.html#modelos-de-supervivencia"><i class="fa fa-check"></i><b>15.3</b> Modelos de supervivencia</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="glmsuperv.html"><a href="glmsuperv.html#hipótesis-del-modelo"><i class="fa fa-check"></i><b>15.3.1</b> Hipótesis del modelo</a></li>
<li class="chapter" data-level="15.3.2" data-path="glmsuperv.html"><a href="glmsuperv.html#análisis-cáncer-de-pulmón"><i class="fa fa-check"></i><b>15.3.2</b> Análisis Cáncer de pulmón</a></li>
<li class="chapter" data-level="15.3.3" data-path="glmsuperv.html"><a href="glmsuperv.html#múltiples-predictoras"><i class="fa fa-check"></i><b>15.3.3</b> Múltiples predictoras</a></li>
<li class="chapter" data-level="15.3.4" data-path="glmsuperv.html"><a href="glmsuperv.html#diagnóstico-del-modelo-2"><i class="fa fa-check"></i><b>15.3.4</b> Diagnóstico del modelo</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="glmsuperv.html"><a href="glmsuperv.html#ejercicios-7"><i class="fa fa-check"></i><b>15.4</b> Ejercicios</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Creado con bookdown</a></li>
<li><a href="https://sites.google.com/umh.es/statistical-models" target="blank">Modelos Estadísticos</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modelos Estadísticos</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="glmbinomial" class="section level1" number="12">
<h1><span class="header-section-number">Unidad 12</span> GLM respuesta binomial</h1>
<p>Consideramos en este tema la modelización de variables respuesta de tipo binario, es decir, para cada individuo, la variable respuesta para cada uno de los sujetos puede tomar únicamente dos posibles valores, que denotaremos por 0 (fracaso) y 1 (éxito),</p>
<p><span class="math display">\[Pr(Y_i = 0) = 1 - \pi_i; \text{ } Pr(Y_i = 1) = \pi_i\]</span></p>
<p>Si además se han observado una serie de covariables continuas o de tipo factor, el objetivo del análisis con el modelo lineal generalizado será predecir la probabilidad asociada al éxito, <span class="math inline">\(\widehat{\pi_i}\)</span>, (o equivalentemente el fracaso), en función de dichas covariables.</p>
<div id="tipos-de-datos-binomiales" class="section level2" number="12.1">
<h2><span class="header-section-number">12.1</span> Tipos de datos binomiales</h2>
<p>Existen dos formas habituales en las que se presenta o se recoge la información experimental sobre variables que miden éxito o fracaso. A continuación detallamos dichas situaciones experimentales y vemos un ejemplo de cada una de ellas.</p>
<div id="información-individualizada-por-sujeto" class="section level3" number="12.1.1">
<h3><span class="header-section-number">12.1.1</span> Información individualizada por sujeto</h3>
<p>En este caso el banco de datos recoge la información de cada sujeto de la muestra con una variable que indica el éxito o el fracaso. Dicha variable se suele codificar 1 (éxito) y 0 (fracaso). Asociada con esta variable binaria se pueden recoger variables predictoras, en cada uno de los sujetos, para tratar de explicar el comportamiento de la respuesta.</p>
<div id="datos-de-kifosis" class="section level4" number="12.1.1.1">
<h4><span class="header-section-number">12.1.1.1</span> Datos de Kifosis</h4>
<p>En este banco de datos aparecen los datos de 81 niños que fueron intervenidos quirúrgicamente para corregirles problemas en la columna vertebral. La variable binaria <code>kifosis</code> indica la presencia o ausencia de una deformidad postoperatoria en la columna, denominada kifosis. Las otras tres variables son <code>Age</code>, edad del niñoo en meses, <code>Number</code>, número de vértebras intervenidas en la operación, y <code>Start</code>, que define la primera vértebra involucrada en la operación. Es de interés en el análisis investigar cómo están relacionadas dichas variables a la hora de predecir la incidencia de la kifosis en el postoperatorio. En este caso todas las variables predictoras son de tipo numérico.</p>
<p>En este caso la variable respuesta se puede representar mediante el modelo <span class="math inline">\(Y_i \sim Bi(n = 1, \pi_i)\)</span>, dado que cada observación corresponde a un único sujeto con <span class="math inline">\(\pi_i\)</span> la probabilidad de sufrir una deformidad postoperatoria para el sujeto <span class="math inline">\(i\)</span>.</p>
<p>Cargamos los datos a partir de la librería <code>rpart</code> y los representamos gráficamente. En este caso realizamos diagramas de caja para cada variable predictora. La variable respuesta viene codificada con las opciones <code>absent</code> y <code>present</code>, por lo que al cargar los datos codificaremos dichos valores como 0 y 1. En este caso el éxito viene marcado por tener la enfermedad.</p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="glmbinomial.html#cb543-1" aria-hidden="true" tabindex="-1"></a>Kyphosis <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, 2L, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>,  <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, </span>
<span id="cb543-2"><a href="glmbinomial.html#cb543-2" aria-hidden="true" tabindex="-1"></a>                     <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb543-3"><a href="glmbinomial.html#cb543-3" aria-hidden="true" tabindex="-1"></a>                     <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb543-4"><a href="glmbinomial.html#cb543-4" aria-hidden="true" tabindex="-1"></a>                     <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb543-5"><a href="glmbinomial.html#cb543-5" aria-hidden="true" tabindex="-1"></a>                     <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, </span>
<span id="cb543-6"><a href="glmbinomial.html#cb543-6" aria-hidden="true" tabindex="-1"></a>                     <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb543-7"><a href="glmbinomial.html#cb543-7" aria-hidden="true" tabindex="-1"></a>                     <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb543-8"><a href="glmbinomial.html#cb543-8" aria-hidden="true" tabindex="-1"></a>                     <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;absent&quot;</span>, <span class="st">&quot;present&quot;</span>))</span>
<span id="cb543-9"><a href="glmbinomial.html#cb543-9" aria-hidden="true" tabindex="-1"></a>Age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">71</span>, <span class="dv">158</span>, <span class="dv">128</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">61</span>, <span class="dv">37</span>, <span class="dv">113</span>, <span class="dv">59</span>, <span class="dv">82</span>, <span class="dv">148</span>, </span>
<span id="cb543-10"><a href="glmbinomial.html#cb543-10" aria-hidden="true" tabindex="-1"></a>         <span class="dv">18</span>, <span class="dv">1</span>, <span class="dv">168</span>, <span class="dv">1</span>, <span class="dv">78</span>, <span class="dv">175</span>, <span class="dv">80</span>, <span class="dv">27</span>, <span class="dv">22</span>, <span class="dv">105</span>, <span class="dv">96</span>, <span class="dv">131</span>, </span>
<span id="cb543-11"><a href="glmbinomial.html#cb543-11" aria-hidden="true" tabindex="-1"></a>         <span class="dv">15</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">100</span>, <span class="dv">4</span>, <span class="dv">151</span>, <span class="dv">31</span>, <span class="dv">125</span>, <span class="dv">130</span>, <span class="dv">112</span>, <span class="dv">140</span>, <span class="dv">93</span>, </span>
<span id="cb543-12"><a href="glmbinomial.html#cb543-12" aria-hidden="true" tabindex="-1"></a>         <span class="dv">1</span>, <span class="dv">52</span>, <span class="dv">20</span>, <span class="dv">91</span>, <span class="dv">73</span>, <span class="dv">35</span>, <span class="dv">143</span>, <span class="dv">61</span>, <span class="dv">97</span>, <span class="dv">139</span>, <span class="dv">136</span>, <span class="dv">131</span>, </span>
<span id="cb543-13"><a href="glmbinomial.html#cb543-13" aria-hidden="true" tabindex="-1"></a>         <span class="dv">121</span>, <span class="dv">177</span>, <span class="dv">68</span>, <span class="dv">9</span>, <span class="dv">139</span>, <span class="dv">2</span>, <span class="dv">140</span>, <span class="dv">72</span>, <span class="dv">2</span>, <span class="dv">120</span>, <span class="dv">51</span>, <span class="dv">102</span>, </span>
<span id="cb543-14"><a href="glmbinomial.html#cb543-14" aria-hidden="true" tabindex="-1"></a>         <span class="dv">130</span>, <span class="dv">114</span>, <span class="dv">81</span>, <span class="dv">118</span>, <span class="dv">118</span>, <span class="dv">17</span>, <span class="dv">195</span>, <span class="dv">159</span>, <span class="dv">18</span>, <span class="dv">15</span>, <span class="dv">158</span>, </span>
<span id="cb543-15"><a href="glmbinomial.html#cb543-15" aria-hidden="true" tabindex="-1"></a>         <span class="dv">127</span>, <span class="dv">87</span>, <span class="dv">206</span>, <span class="dv">11</span>, <span class="dv">178</span>, <span class="dv">157</span>, <span class="dv">26</span>, <span class="dv">120</span>, <span class="dv">42</span>, <span class="dv">36</span>) </span>
<span id="cb543-16"><a href="glmbinomial.html#cb543-16" aria-hidden="true" tabindex="-1"></a>Number <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">6</span>, </span>
<span id="cb543-17"><a href="glmbinomial.html#cb543-17" aria-hidden="true" tabindex="-1"></a>            <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">3</span>, </span>
<span id="cb543-18"><a href="glmbinomial.html#cb543-18" aria-hidden="true" tabindex="-1"></a>            <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">9</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>, </span>
<span id="cb543-19"><a href="glmbinomial.html#cb543-19" aria-hidden="true" tabindex="-1"></a>            <span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">4</span>, </span>
<span id="cb543-20"><a href="glmbinomial.html#cb543-20" aria-hidden="true" tabindex="-1"></a>            <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">2</span>, <span class="dv">7</span>, <span class="dv">4</span>) </span>
<span id="cb543-21"><a href="glmbinomial.html#cb543-21" aria-hidden="true" tabindex="-1"></a>Start <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">14</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">16</span>, <span class="dv">16</span>, <span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">16</span>, <span class="dv">2</span>, <span class="dv">12</span>, </span>
<span id="cb543-22"><a href="glmbinomial.html#cb543-22" aria-hidden="true" tabindex="-1"></a>           <span class="dv">18</span>, <span class="dv">16</span>, <span class="dv">15</span>, <span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">9</span>, <span class="dv">16</span>, <span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">13</span>, <span class="dv">6</span>, <span class="dv">14</span>, </span>
<span id="cb543-23"><a href="glmbinomial.html#cb543-23" aria-hidden="true" tabindex="-1"></a>           <span class="dv">16</span>, <span class="dv">16</span>, <span class="dv">16</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">11</span>, <span class="dv">16</span>, <span class="dv">9</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>, <span class="dv">1</span>, <span class="dv">13</span>, </span>
<span id="cb543-24"><a href="glmbinomial.html#cb543-24" aria-hidden="true" tabindex="-1"></a>           <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">16</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">13</span>, <span class="dv">3</span>, <span class="dv">14</span>, <span class="dv">10</span>, <span class="dv">17</span>, <span class="dv">6</span>, <span class="dv">17</span>, <span class="dv">15</span>, <span class="dv">15</span>, </span>
<span id="cb543-25"><a href="glmbinomial.html#cb543-25" aria-hidden="true" tabindex="-1"></a>           <span class="dv">13</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">13</span>, <span class="dv">1</span>, <span class="dv">8</span>, <span class="dv">1</span>, <span class="dv">16</span>, <span class="dv">16</span>, <span class="dv">10</span>, <span class="dv">17</span>, <span class="dv">13</span>, <span class="dv">11</span>, <span class="dv">16</span>, </span>
<span id="cb543-26"><a href="glmbinomial.html#cb543-26" aria-hidden="true" tabindex="-1"></a>           <span class="dv">14</span>, <span class="dv">12</span>, <span class="dv">16</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">13</span>, <span class="dv">13</span>, <span class="dv">13</span>, <span class="dv">6</span>, <span class="dv">13</span>)</span>
<span id="cb543-27"><a href="glmbinomial.html#cb543-27" aria-hidden="true" tabindex="-1"></a>kyphosis <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Kyphosis, Age, Number, Start)</span>
<span id="cb543-28"><a href="glmbinomial.html#cb543-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Recodificación a 0 - 1</span></span>
<span id="cb543-29"><a href="glmbinomial.html#cb543-29" aria-hidden="true" tabindex="-1"></a>kyphosisb <span class="ot">=</span> kyphosis <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Kyphosis =</span> <span class="dv">1</span><span class="sc">*</span>(Kyphosis<span class="sc">==</span><span class="st">&quot;present&quot;</span>))</span>
<span id="cb543-30"><a href="glmbinomial.html#cb543-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráficos de predictoras y variable</span></span>
<span id="cb543-31"><a href="glmbinomial.html#cb543-31" aria-hidden="true" tabindex="-1"></a>datacomp <span class="ot">=</span> <span class="fu">melt</span>(kyphosis, <span class="at">id.vars=</span><span class="st">&#39;Kyphosis&#39;</span>)</span>
<span id="cb543-32"><a href="glmbinomial.html#cb543-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datacomp) <span class="sc">+</span></span>
<span id="cb543-33"><a href="glmbinomial.html#cb543-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(Kyphosis,value, <span class="at">colour=</span>variable)) <span class="sc">+</span> </span>
<span id="cb543-34"><a href="glmbinomial.html#cb543-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scales =</span><span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb543-35"><a href="glmbinomial.html#cb543-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Kyphosis&quot;</span>) </span></code></pre></div>
<p><img src="libroSTAT_files/figure-html/binom001-1.png" width="672" /></p>
<p>En dichos gráficos podemos ver como hay más incidencia de la enfermedad para los bebes más grandes y cuando el número de vértebras intervenidas es inferior, mientras que disminuye cuando la primera vértebra involucrada en la operación tiene un valor más bajo, es decir, se sitúa más arriba en la columna vertebral.</p>
</div>
</div>
<div id="información-agrupada-por-sujetos" class="section level3" number="12.1.2">
<h3><span class="header-section-number">12.1.2</span> Información agrupada por sujetos</h3>
<p>Los bancos de datos de este tipo suelen identificar por fila el “tratamiento” al que se ven sometidos un grupo de sujetos, registrándose el número total de sujetos en esa combinación y el número de éxitos (en algunos casos se recogen los éxitos y fracasos para dicha combinación). El “tratamiento” puede ser la combinación de una o más predictoras. Estos bancos de datos son muy habituales en ensayos de dosis-repuesta donde únicamente queremos valorar eficacia, ya que no es necesario recoger una información exhaustiva sobre los sujetos bajo estudio. En estos casos no estimamos la probabilidad de éxito individual sino del grupo de sujetos que se ven sometidos al mismo tratamiento. La información muestral debe recoger la probabilidad de éxito asociada a cada combinación.</p>
<div id="datos-dosis-respuesta" class="section level4" number="12.1.2.1">
<h4><span class="header-section-number">12.1.2.1</span> Datos dosis-respuesta</h4>
<p>Collet (1991) presenta un experimento sobre la toxicidad de distintas dosis (en microgramos) del piretroide trnas-cipemetrín en los capullos de gusano del tabaco. Se había comenzado a detectar resistencia de esas polillas a dicho tóxico. El experimento consistía en exponer, durante tres días y a distintas dosis de tóxico, a series de 20 polillas de cada sexo (<code>total</code>). Se anotaron el número de polillas muertas en cada serie (<code>dead</code>). Es de interés en el análisis investigar si efectivamente se demostraba tal resistencia al tóxico en función del sexo de la polilla (<code>sex</code>) y a partir de qué dosis (<code>dosis</code>). También se desea determinar la dosis a la cual es posible garantizar el exterminio del 50% de los insectos.</p>
<p>En este caso tenemos un modelo <span class="math inline">\(Y_i \sim Bi(n = 20, \pi_i)\)</span>, con <span class="math inline">\(\pi_i\)</span> la probabilidad de morir para una polilla en la combinación dosis-sexo.</p>
<p>Veamos los datos para este experimento y la representación gráfica. Utilizamos la variable <code>log(dosis)</code> como es habitual en este tipo de experimentos para linealizar la relación entre probabilidad de éxito y dosis .</p>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="glmbinomial.html#cb544-1" aria-hidden="true" tabindex="-1"></a>Dosis <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://goo.gl/w23RGz&quot;</span>, <span class="at">col_types =</span> <span class="st">&quot;cdii&quot;</span>)</span>
<span id="cb544-2"><a href="glmbinomial.html#cb544-2" aria-hidden="true" tabindex="-1"></a>Dosis</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:binom002">
<caption style="caption-side: top; text-align: center;"><span id="tab:binom002">Tabla 12.1: </span> </caption><col><col><col><col><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">sex</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dosis</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">total</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dead</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">M</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">M</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">M</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">4</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">9</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">M</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">8</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">13</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">M</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">16</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">18</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">M</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">32</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">20</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">F</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">F</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">F</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">4</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">6</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">F</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">8</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">10</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">F</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">16</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">12</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">F</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">32</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">16</td></tr>
</table>

<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="glmbinomial.html#cb545-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculamos los vivos, la probabilidad de morir, y el </span></span>
<span id="cb545-2"><a href="glmbinomial.html#cb545-2" aria-hidden="true" tabindex="-1"></a><span class="co"># logaritmo de dosis que es la forma habitual de medir </span></span>
<span id="cb545-3"><a href="glmbinomial.html#cb545-3" aria-hidden="true" tabindex="-1"></a><span class="co"># en este tipo de situaciones</span></span>
<span id="cb545-4"><a href="glmbinomial.html#cb545-4" aria-hidden="true" tabindex="-1"></a>Dosis <span class="ot">=</span> Dosis <span class="sc">%&gt;%</span>  </span>
<span id="cb545-5"><a href="glmbinomial.html#cb545-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alive =</span> total <span class="sc">-</span> dead, <span class="at">probabilidad =</span> dead<span class="sc">/</span>total, <span class="at">ldosis =</span> <span class="fu">log</span>(dosis))</span>
<span id="cb545-6"><a href="glmbinomial.html#cb545-6" aria-hidden="true" tabindex="-1"></a>Dosis</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:binom002">
<caption style="caption-side: top; text-align: center;"><span id="tab:binom002">Tabla 12.1: </span> </caption><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">sex</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dosis</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">total</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">dead</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">alive</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">probabilidad</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">ldosis</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">M</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">19</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.05</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">M</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">16</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.2&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.693</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">M</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">4</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">9</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">11</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.45</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.39&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">M</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">8</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">13</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">7</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.65</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2.08&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">M</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">16</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">18</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">2</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.9&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">2.77&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">M</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">32</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.47&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">F</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">F</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">18</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.1&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.693</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">F</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">4</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">6</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">14</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.3&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.39&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">F</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">8</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">10</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">10</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.5&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2.08&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">F</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">16</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">12</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">8</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">0.6&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">2.77&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">F</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">32</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">20</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">16</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.8&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.47&nbsp;</td></tr>
</table>

<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="glmbinomial.html#cb546-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Representamos la probabilidad de morir en función de </span></span>
<span id="cb546-2"><a href="glmbinomial.html#cb546-2" aria-hidden="true" tabindex="-1"></a><span class="co"># las covariables sex y ldosis</span></span>
<span id="cb546-3"><a href="glmbinomial.html#cb546-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Dosis,<span class="fu">aes</span>(<span class="at">x =</span> ldosis, <span class="at">y =</span> probabilidad, <span class="at">color =</span> sex)) <span class="sc">+</span> </span>
<span id="cb546-4"><a href="glmbinomial.html#cb546-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb546-5"><a href="glmbinomial.html#cb546-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Logaritmo Dosis&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Probabilidad de morir&quot;</span>) </span></code></pre></div>
<p><img src="libroSTAT_files/figure-html/binom002-1.png" width="672" /></p>
<p>Se observa que para la misma dosis la probabilidad de morir en las hembras es menor que en los machos. Además, hay una tendencia creciente con la dosis, es decir, cuanto aumenta la dosis aumenta la probabilidad de morir.</p>
</div>
</div>
</div>
<div id="especificación-e-hipótesis-de-modelo" class="section level2" number="12.2">
<h2><span class="header-section-number">12.2</span> Especificación e hipótesis de modelo</h2>
<p>Las hipótesis que debe verificar los modelos de este tipo son:</p>
<ul>
<li>independencia entre las observaciones</li>
<li>linealidad entre transformaciones de la proporción de éxitos y de las variables explicativas continuas (función link)</li>
<li>consistencia entre la modelización y la interpretación física.</li>
</ul>
<p>Si <span class="math inline">\(\pi_i\)</span> es la probabilidad de éxito asociado al i-ésimo experimento binomial con respuesta <span class="math inline">\(Y_i\)</span>, y condiciones de experimentación observadas en las variables predictoras <span class="math inline">\(X_1;X_2,...,X_p\)</span>, la formulación del GLM viene dada por:</p>
<p><span class="math display">\[g(\pi_i) = \eta_i = \beta_0 + \beta_1 x_{i1} + \beta_2 x_{21} + ... + \beta_p x_{ip}\]</span></p>
<p>donde <span class="math inline">\(g()\)</span> es la función link asociada con este tipo de datos. En este tipo de modelos los coeficientes <span class="math inline">\(\beta_i\)</span> representan el incremento o decremento sobre la función de enlace que nos permite linealizar la relación entre la probabilidad de éxito y las variables predictora o predictor lineal.</p>
<p>A continuación, presentamos las diferentes posibilidades de funciones link para este tipo de datos.</p>
<div id="funciones-link" class="section level3" number="12.2.1">
<h3><span class="header-section-number">12.2.1</span> Funciones link</h3>
<p>En este tipo de modelos se contemplan diferentes funciones link. De forma habitual se suelen ajustar los modelos obtenidos para función de enlace, y nos quedamos con aquel modelo, y por tanto función de enlace, con mejor capacidad explicativa.</p>
<div id="link-logit" class="section level4" number="12.2.1.1">
<h4><span class="header-section-number">12.2.1.1</span> link logit</h4>
<p>El link logit proporciona los comúnmente conocidos como modelos de regresión logística y su expresión viene dada por:</p>
<p><span class="math display">\[g(\pi_i) = log\left( \frac{\pi_i}{1-\pi_i}\right) = \beta_0 + \beta_1 x_{i1} + \beta_2 x_{21} + ... + \beta_p x_{ip}\]</span></p>
<p>En esta situación la probabilidad de éxito se puede escribir en términos de las variables predictoras (despejando de la ecuación anterior) como:</p>
<p><span class="math display">\[\pi_i = \frac{exp(\beta_0 + \beta_1 x_{i1} + \beta_2 x_{21} + ... + \beta_p x_{ip})}{1+exp(\beta_0 + \beta_1 x_{i1} + \beta_2 x_{21} + ... + \beta_p x_{ip})} \]</span></p>
<p>Si <span class="math inline">\(\pi_i (x_1)\)</span> y <span class="math inline">\(\pi_i (x_2)\)</span> denotan las probabilidades de éxito para dos valores de la predictora (<span class="math inline">\(x_1\)</span> y <span class="math inline">\(x_2\)</span>), el cociente <span class="math inline">\((\pi_i (x_1)/(1-\pi_i (x_1))) / (\pi_i (x_2)/(1-\pi_i (x_2)))\)</span> se denomina odds ratio y valora la relación entre probabilidad de éxito y fracaso para dos valores de la covaraible, de forma que:</p>
<ul>
<li>un valor mayor que 1 indica un aumento de la probabilidad de éxito en <span class="math inline">\(x_1\)</span> con respecto a <span class="math inline">\(x_2\)</span>,</li>
<li>un valor menor que 1 indica un decremento de la probabilidad de éxito en <span class="math inline">\(x_1\)</span> con respecto a <span class="math inline">\(x_2\)</span>.</li>
</ul>
<p>En términos del modelo ajustado se puede valorar el incremento o decremento del odds ratio con el valor de <span class="math inline">\(exp(\beta_i)\)</span>, para cada uno de los efectos (variables numéricas o niveles de un factor) presentes en el modelo. Valores negativos de <span class="math inline">\(\beta_i\)</span> dan lugar a odds ratios menores que 1, mientras que valores de <span class="math inline">\(\beta_i\)</span> positivos dan odds ratios positivos.</p>
<p>De hecho, esta propiedad es la que motiva que esta función de enlace sea la más utilizada en este tipo de modelos.</p>
<p>En <code>R</code> podemos obtener el valor de la función enlace para cualquier probabilidad con la sentencia</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="glmbinomial.html#cb547-1" aria-hidden="true" tabindex="-1"></a><span class="fu">binomial</span>(<span class="at">link =</span> logit)<span class="sc">$</span><span class="fu">linlfun</span>(probabilidad)</span></code></pre></div>
<p>y el valor de la probabilidad de éxito a partir del valor del predictor lineal con</p>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="glmbinomial.html#cb548-1" aria-hidden="true" tabindex="-1"></a><span class="fu">binomial</span>(<span class="at">link =</span> logit)<span class="sc">$</span><span class="fu">linlinv</span>(predictor)</span></code></pre></div>
</div>
<div id="link-probit" class="section level4" number="12.2.1.2">
<h4><span class="header-section-number">12.2.1.2</span> link probit</h4>
<p>El link probit proporciona los comúnmente conocidos como modelos de regresión probit y su expresión viene dada por:</p>
<p><span class="math display">\[g(\pi_i) = \Phi^{-1}(\pi_i) = \beta_0 + \beta_1 x_{i1} + \beta_2 x_{21} + ... + \beta_p x_{ip}\]</span>
donde <span class="math inline">\(\Phi^{-1}\)</span> es la función inversa de la función de distribución Normal estándar. En esta situación la probabilidad de éxito se puede escribir en términos de las variables predictoras (despejando de la ecuación anterior) como:</p>
<p><span class="math display">\[\pi_i = \Phi(\beta_0 + \beta_1 x_{i1} + \beta_2 x_{21} + ... + \beta_p x_{ip})\]</span>
donde <span class="math inline">\(\Phi\)</span> es la función de distribución Normal estándar.</p>
</div>
<div id="link-cloglog" class="section level4" number="12.2.1.3">
<h4><span class="header-section-number">12.2.1.3</span> link cloglog</h4>
<p>El link cloglog es el menos habitual en la práctica y su expresión viene dada por:</p>
<p><span class="math display">\[g(\pi_i) = log(-log(1-\pi_i)) = \beta_0 + \beta_1 x_{i1} + \beta_2 x_{21} +...+\beta_p x_{ip}\]</span>
¿Cuál es la probabilidad de éxito en este caso?</p>
<p>La diferencia entre un link y otro hace referencia a como modelizamos las probabilidades más extremas, es decir, las muy bajas o muy altas, pero en la práctica proporcionan resultados muy similares. Por eso casi siempre el modelo utilizado es el de regresión logística.</p>
</div>
</div>
<div id="representación-de-las-funciones-link" class="section level3" number="12.2.2">
<h3><span class="header-section-number">12.2.2</span> Representación de las funciones link</h3>
<p>Para poder comparar los diferentes links presentados veamos cual es su comportamiento en función de la probabilidad de éxito, lo que se denomina en los modelos de dosis-respuesta función de tolerancia. Respectivamente se representan el link logit (línea continua), link probit (línea discontinua), link cloglog (puntos):</p>
<p><img src="libroSTAT_files/figure-html/binom003-1.png" width="672" /></p>
<p>En este gráfico se puede apreciar las pequeñas diferencias entre las funciones de enlace. Podemos ver que para un valor del predictor lineal de 2.5 la probabilidad de éxito en los modelos probit y cloglog es 1 mientras que para el modelo logit está próxima a 0.9. La elección de un tipo de enlace u otro dependerá por tanto del comportamiento de los datos observados.</p>
<p>Representamos a continuación las diferentes funciones link para los datos de dosis-respuesta. Este gráfico sólo se puede hacer para datos en formato agrupado.</p>
<p><img src="libroSTAT_files/figure-html/binom004-1.png" width="672" /></p>
<p>Se aprecia como las tres funciones de enlace tienen un comportamiento muy similar. En el resto de esta unidad mostraremos los resultados correspondientes al modelo de regresión logística (link logit), e indicaremos como obtener los modelos para el resto de funciones link.</p>
</div>
</div>
<div id="estimación-y-bondad-de-ajuste" class="section level2" number="12.3">
<h2><span class="header-section-number">12.3</span> Estimación y bondad de ajuste</h2>
<p>Para la estimación utilizamos la función <code>glm</code> con las especificaciones siguientes:</p>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="glmbinomial.html#cb549-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo de regresión logística</span></span>
<span id="cb549-2"><a href="glmbinomial.html#cb549-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(modelo,<span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit),data_set)</span>
<span id="cb549-3"><a href="glmbinomial.html#cb549-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo de regresión probit</span></span>
<span id="cb549-4"><a href="glmbinomial.html#cb549-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(modelo,<span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> probit),data_set)</span>
<span id="cb549-5"><a href="glmbinomial.html#cb549-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo cloglog</span></span>
<span id="cb549-6"><a href="glmbinomial.html#cb549-6" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(modelo,<span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> cloglog),data_set)</span></code></pre></div>
<p>Sin embargo, la especificación del modelo varía en función del tipo de datos (individualizados o conteos). En el caso de nuestro banco de datos contenga información individualizada para cada sujeto la variable respuesta se debe codificar con un 1 para el éxito y 0 para el fracaso, y el modelo se especifica como:</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="glmbinomial.html#cb550-1" aria-hidden="true" tabindex="-1"></a>respuesta <span class="sc">~</span> predictoras</span></code></pre></div>
<p>En el caso de disponer del número de éxitos y fracasos el modelo se especifica e la forma siguiente:</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="glmbinomial.html#cb551-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(exitos,fracasos) <span class="sc">~</span> predictoras</span></code></pre></div>
<div id="ejemplos-13" class="section level3" number="12.3.1">
<h3><span class="header-section-number">12.3.1</span> Ejemplos</h3>
<p>Estudiamos ahora el proceso de estimación del modelo completo (con todos los efectos posibles) para cada uno de los ejemplos. Utilizamos la función <code>tab_model()</code> con diferentes especificaciones para obtener las estimaciones de los parámetros del modelo (predictor lineal) y de los odds ratios.</p>
<div id="kyphosis" class="section level4" number="12.3.1.1">
<h4><span class="header-section-number">12.3.1.1</span> Kyphosis</h4>
<p>En este caso ya hemos creado un variable para identificar el éxito (tener malformación postoperatoria) o el fracaso (no tener malformación) para cada sujeto de la muestra. El banco de datos es <code>kyphosisb</code> con variable respuesta <code>Kyphosis</code> y con tres posibles variables predictoras de tipo numérico: <code>Age</code>, <code>Number</code>, <code>Start</code>.
Para ajustar el modelo de regresión logística escribimos:</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="glmbinomial.html#cb552-1" aria-hidden="true" tabindex="-1"></a>fit.kyphosis <span class="ot">&lt;-</span> <span class="fu">glm</span>(Kyphosis  <span class="sc">~</span> Age <span class="sc">+</span> Number <span class="sc">+</span> Start,</span>
<span id="cb552-2"><a href="glmbinomial.html#cb552-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit),</span>
<span id="cb552-3"><a href="glmbinomial.html#cb552-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> kyphosisb)</span></code></pre></div>
<p>Veamos las estimaciones del modelo ajustado:</p>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="glmbinomial.html#cb553-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen del predictor lineal</span></span>
<span id="cb553-2"><a href="glmbinomial.html#cb553-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(fit.kyphosis, </span>
<span id="cb553-3"><a href="glmbinomial.html#cb553-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">transform =</span> <span class="cn">NULL</span>, </span>
<span id="cb553-4"><a href="glmbinomial.html#cb553-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">string.est =</span> <span class="st">&quot;Estimate&quot;</span>,</span>
<span id="cb553-5"><a href="glmbinomial.html#cb553-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">show.r2 =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Kyphosis
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Estimate
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
(Intercept)
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-2.04
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-5.11 – 0.67
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.160
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Age
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.01
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.00 – 0.02
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.090
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Number
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.41
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.00 – 0.90
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.068
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Start
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.21
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.35 – -0.08
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.002</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">
81
</td>
</tr>
</table>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="glmbinomial.html#cb554-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico</span></span>
<span id="cb554-2"><a href="glmbinomial.html#cb554-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(fit.kyphosis, </span>
<span id="cb554-3"><a href="glmbinomial.html#cb554-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">transform =</span> <span class="cn">NULL</span>, </span>
<span id="cb554-4"><a href="glmbinomial.html#cb554-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;&quot;</span>),</span>
<span id="cb554-5"><a href="glmbinomial.html#cb554-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="libroSTAT_files/figure-html/binom009-1.png" width="672" /></p>
<p>A la vista de los coeficientes estimados se desprende que la única preditora que parece tener influencia en la probabilidad de observar una malformación es la variable <code>Start</code>. Dado que el coeficiente es negativo dicha probabilidad disminuye cuando aumenta dicha variable. La ecuación del modelo viene dada por:</p>
<p><span class="math display">\[log\left( \frac{\hat{\pi}_i}{1-\hat{\pi}_i}\right) = -2.04 + 0.01 *Age_{i} + 0.41 *Number_{1} - 0.21 *Start_{i}\]</span></p>
<p>donde la probabilidad de éxito es:</p>
<p><span class="math display">\[\pi_i = \frac{exp(-2.04 + 0.01 * Age_{i} + 0.41* Number_{i} - 0.21* Start_{i})}{1 -exp(2.04 + 0.01* Age_{i} + 0.41* Number_{i} - 0.21* Start_{i})}\]</span></p>
<p>Los odds ratios asociados a cada variable presente en el modelo vienen dados por</p>
<p><span class="math display">\[
\begin{array}{ll}
odds(Age) = &amp; exp(0.01) = 1.01\\
odds(Number) = &amp; exp(0.41) = 1.51\\
odds(Start) = &amp; exp(-0.21) = 0.81\\
\end{array}
\]</span></p>
<p>En términos de los odds ratios podemos ver que la probabilidad de sufrir una malformación aumenta 1.01 y 1.51 al aumentar respectivamente las variables <code>Age</code> y <code>Number</code>, es decir, la probabilidad de sufrir una malformación al incrementar en una unidad el número de vértebras intervenidas es 1.5 (odds ratio) veces superior que de no padecerla. Con la variable <code>Start</code> podemos ver que la relación entre sufrir la malformación es 0.81 veces la probabilidad de no sufrirla, es decir, disminuye al aumentar la vértebra de inicio.</p>
<p>Con la formulación siguiente podemos obtener y representar de forma directa los odds ratios asociados al modelo analizado:</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="glmbinomial.html#cb555-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen del predictor lineal</span></span>
<span id="cb555-2"><a href="glmbinomial.html#cb555-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(fit.kyphosis, </span>
<span id="cb555-3"><a href="glmbinomial.html#cb555-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">show.r2 =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Kyphosis
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Odds Ratios
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
(Intercept)
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.13
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.01 – 1.95
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.160
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Age
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.01
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.00 – 1.02
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.090
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Number
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.51
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.00 – 2.45
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.068
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Start
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.81
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.71 – 0.92
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.002</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">
81
</td>
</tr>
</table>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="glmbinomial.html#cb556-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico</span></span>
<span id="cb556-2"><a href="glmbinomial.html#cb556-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(fit.kyphosis, </span>
<span id="cb556-3"><a href="glmbinomial.html#cb556-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="libroSTAT_files/figure-html/binom010-1.png" width="672" /></p>
<p>De todas formas hay que ser cautelosos en la interpretación dado que todavía no hemos validado el modelo ni hemos realizado el proceso de selección de efectos relevantes en el modelo.</p>
<p>Para realizar la bondad de ajuste del modelo obtenemos los estadísticos asociados (función <code>glance</code>) y el contraste de bondad de ajuste utilizando la deviance explicada y sus grados de libertad asociados utilizando el test <span class="math inline">\(\chi^2\)</span>.</p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="glmbinomial.html#cb557-1" aria-hidden="true" tabindex="-1"></a><span class="co"># P-valor del contraste</span></span>
<span id="cb557-2"><a href="glmbinomial.html#cb557-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(fit.kyphosis<span class="sc">$</span>deviance,fit.kyphosis<span class="sc">$</span>df.residual)</span></code></pre></div>
<pre><code>## [1] 0.9033442</code></pre>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="glmbinomial.html#cb559-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bondad del ajuste</span></span>
<span id="cb559-2"><a href="glmbinomial.html#cb559-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(fit.kyphosis)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:binom011">
<caption style="caption-side: top; text-align: center;"><span id="tab:binom011">Tabla 12.2: </span> </caption><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">null.deviance</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">df.null</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">logLik</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">BIC</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">deviance</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">df.residual</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">nobs</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">83.2</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">80</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">-30.7</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">69.4</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">79</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">61.4</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">77</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">81</td></tr>
</table>

<p>El p-valor obtenido es superior a 0.05 indicando que el modelo considerado tiene una buena capacidad explicativa. En el punto siguiente estudiaremos la selección de variables para quedarnos con el mejor modelo posible.</p>
</div>
<div id="dosis-respuesta" class="section level4" number="12.3.1.2">
<h4><span class="header-section-number">12.3.1.2</span> Dosis-Respuesta</h4>
<p>En este caso trabajamos con datos agrupados que contabilizan los éxitos (número de polillas muertas) y los fracasos (número de polillas vivas) para cada combinación considerada en el diseño experimental. Se consideran las variables predictoras <code>sex</code> (categórica) y <code>dosis</code> (numérica).</p>
<p>El banco de datos es <code>Dosis</code> y contiene además las polillas totales, muertas y vivas (calculadas como muertas - vivas), y el logaritmo de la dosis suministrada, ya que de forma habitual en este tipo de modelos se suele trabajar en dicha escala logarítmica. Para ajustar el modelo de regresión logística consideramos los efectos asociados con cada predictora, así como la posible interacción entre ambos:</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="glmbinomial.html#cb560-1" aria-hidden="true" tabindex="-1"></a>Yres <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Dosis<span class="sc">$</span>dead,Dosis<span class="sc">$</span>alive)</span>
<span id="cb560-2"><a href="glmbinomial.html#cb560-2" aria-hidden="true" tabindex="-1"></a>fit.dosis <span class="ot">&lt;-</span> <span class="fu">glm</span>(Yres  <span class="sc">~</span> sex <span class="sc">*</span> ldosis,</span>
<span id="cb560-3"><a href="glmbinomial.html#cb560-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit),</span>
<span id="cb560-4"><a href="glmbinomial.html#cb560-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> Dosis)</span></code></pre></div>
<p>Analizamos el modelo obtenido:</p>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="glmbinomial.html#cb561-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen del predictor lineal</span></span>
<span id="cb561-2"><a href="glmbinomial.html#cb561-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(fit.dosis, </span>
<span id="cb561-3"><a href="glmbinomial.html#cb561-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">transform =</span> <span class="cn">NULL</span>,</span>
<span id="cb561-4"><a href="glmbinomial.html#cb561-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">string.est =</span> <span class="st">&quot;Estimate&quot;</span>,</span>
<span id="cb561-5"><a href="glmbinomial.html#cb561-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">show.r2 =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Yres
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Estimate
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
(Intercept)
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-2.99
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-4.19 – -2.00
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
sex [M]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.17
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-1.37 – 1.72
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.822
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
ldosis
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.31
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.87 – 1.82
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
sex [M] * ldosis
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.51
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.24 – 1.31
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.191
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">
12
</td>
</tr>
</table>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="glmbinomial.html#cb562-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico</span></span>
<span id="cb562-2"><a href="glmbinomial.html#cb562-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(fit.dosis, </span>
<span id="cb562-3"><a href="glmbinomial.html#cb562-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">transform =</span> <span class="cn">NULL</span>, </span>
<span id="cb562-4"><a href="glmbinomial.html#cb562-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title =</span> <span class="fu">c</span>(<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;&quot;</span>),</span>
<span id="cb562-5"><a href="glmbinomial.html#cb562-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.values =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="libroSTAT_files/figure-html/binom013-1.png" width="672" /></p>
<p>De los resultados obtenidos parece desprenderse que no existe efecto de interacción entre sexo y dosis. Antes de tratar de explicar el resto de efectos deberemos estudiar la posibilidad de eliminar dicho efecto del modelo. Las ecuaciones de este modelo vienen dadas por:</p>
<p><span class="math display">\[
log\left(\frac{\widehat{\pi_i}}{1-\widehat{\pi_i}}\right)_{Machos} = -2.82 + 1.82 * ldosis_{i} 
\]</span></p>
<p><span class="math display">\[
log\left(\frac{\widehat{\pi_i}}{1-\widehat{\pi_i}}\right)_{Hembras} = -2.99 + 1.31 * ldosis_{i}
\]</span></p>
<p>En el punto siguiente seleccionaremos el mejor modelo e interpretaremos con detalle los coeficientes y los odds-ratios estimados.</p>
<p>Por otro lado, el p-valor para valorar la bondad del ajuste:</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="glmbinomial.html#cb563-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(fit.dosis<span class="sc">$</span>deviance,fit.dosis<span class="sc">$</span>df.residual)</span></code></pre></div>
<pre><code>## [1] 0.7582464</code></pre>
<p>parece indicar que el ajuste obtenido es bueno, dado que es superior a 0.05.</p>
</div>
</div>
</div>
<div id="selección-del-modelo" class="section level2" number="12.4">
<h2><span class="header-section-number">12.4</span> Selección del modelo</h2>
<p>Para la construcción del mejor modelo utilizaremos los mismos procedimientos secuenciales de selección de efectos que vimos en unidades anteriores. En este caso disponemos del criterio Deviance, del AIC y del test <span class="math inline">\(\chi^2\)</span> (p-valor significativo o no) para valorar los efectos del modelo. En este caso utilizaremos el AIC dado que los p-valores son aproximados en este tipo de modelos, y tienen que ser interpretados con mucha cautela.</p>
<p>Para realizar la selección del modelo utilizaremos el procedimiento:</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="glmbinomial.html#cb565-1" aria-hidden="true" tabindex="-1"></a>modelo.final <span class="ot">&lt;-</span> <span class="fu">step</span>(modelo)</span></code></pre></div>
<div id="ejemplos-14" class="section level3" number="12.4.1">
<h3><span class="header-section-number">12.4.1</span> Ejemplos</h3>
<p>Estudiamos a continuación cada uno de los ejemplos.</p>
<div id="kyphosis-1" class="section level4" number="12.4.1.1">
<h4><span class="header-section-number">12.4.1.1</span> Kyphosis</h4>
<p>Realizamos la selección del modelo:</p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="glmbinomial.html#cb566-1" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">::</span><span class="fu">step</span>(fit.kyphosis)</span></code></pre></div>
<pre><code>## Start:  AIC=69.38
## Kyphosis ~ Age + Number + Start
## 
##          Df Deviance    AIC
## &lt;none&gt;        61.380 69.380
## - Age     1   64.536 70.536
## - Number  1   65.299 71.299
## - Start   1   71.627 77.627</code></pre>
<pre><code>## 
## Call:  glm(formula = Kyphosis ~ Age + Number + Start, family = binomial(link = logit), 
##     data = kyphosisb)
## 
## Coefficients:
## (Intercept)          Age       Number        Start  
##    -2.03693      0.01093      0.41060     -0.20651  
## 
## Degrees of Freedom: 80 Total (i.e. Null);  77 Residual
## Null Deviance:       83.23 
## Residual Deviance: 61.38     AIC: 69.38</code></pre>
<p>El proceso de selección de efectos indica que no podemos eliminar ninguna variable del modelo (todos los AIC asociados con las predictoras aumentan al eliminarlas). Los valores de Deviance siempre aumentan (deviance asociada a cada variable) cuando eliminamos cualquiera de las variables con respecto a la del modelo que se queda con todas ellas (<code>&lt;none&gt;</code>). Lo mismo ocurre con el estadístico AIC.</p>
<p>Por tanto, el modelo final es el obtenido en el punto anterior. Todo el análisis de los coeficientes y de los odds ratios ya fue detallado y no se repite aquí.</p>
</div>
<div id="dosis-respuesta-1" class="section level4" number="12.4.1.2">
<h4><span class="header-section-number">12.4.1.2</span> Dosis-respuesta</h4>
<p>Realizamos la selección para el modelo de dosis-respuesta:</p>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="glmbinomial.html#cb569-1" aria-hidden="true" tabindex="-1"></a>stats<span class="sc">::</span><span class="fu">step</span>(fit.dosis)</span></code></pre></div>
<pre><code>## Start:  AIC=43.1
## Yres ~ sex * ldosis
## 
##              Df Deviance    AIC
## - sex:ldosis  1   6.7571 42.867
## &lt;none&gt;            4.9937 43.104
## 
## Step:  AIC=42.87
## Yres ~ sex + ldosis
## 
##          Df Deviance     AIC
## &lt;none&gt;         6.757  42.867
## - sex     1   16.984  51.094
## - ldosis  1  118.799 152.909</code></pre>
<pre><code>## 
## Call:  glm(formula = Yres ~ sex + ldosis, family = binomial(link = logit), 
##     data = Dosis)
## 
## Coefficients:
## (Intercept)         sexM       ldosis  
##      -3.473        1.101        1.535  
## 
## Degrees of Freedom: 11 Total (i.e. Null);  9 Residual
## Null Deviance:       124.9 
## Residual Deviance: 6.757     AIC: 42.87</code></pre>
<p>El proceso de selección indica que no debemos considerar el efecto de interacción ya que el valor de deviance es inferior cuando está presente que cuando lo eliminamos, el AIC aumenta al eliminarlo. El resto de efectos del modelo no pueden ser eliminados. Esto implica que al no haber efecto de interacción la probabilidad de morir se puede obtener mediante comportamientos paralelos para machos y hembras.</p>
<p>Ajustamos el modelo sin interacción y realizamos el análisis de dicho modelo:</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="glmbinomial.html#cb572-1" aria-hidden="true" tabindex="-1"></a>fit.dosis <span class="ot">&lt;-</span> <span class="fu">glm</span>(Yres <span class="sc">~</span> sex <span class="sc">+</span> ldosis,</span>
<span id="cb572-2"><a href="glmbinomial.html#cb572-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit),</span>
<span id="cb572-3"><a href="glmbinomial.html#cb572-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> Dosis)</span></code></pre></div>
<p>La inferencia sobre el modelo viene dada por:</p>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="glmbinomial.html#cb573-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen del predictor lineal</span></span>
<span id="cb573-2"><a href="glmbinomial.html#cb573-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(fit.dosis, </span>
<span id="cb573-3"><a href="glmbinomial.html#cb573-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">transform =</span> <span class="cn">NULL</span>,</span>
<span id="cb573-4"><a href="glmbinomial.html#cb573-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">string.est =</span> <span class="st">&quot;Estimate&quot;</span>,</span>
<span id="cb573-5"><a href="glmbinomial.html#cb573-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">show.r2 =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Yres
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Estimate
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
(Intercept)
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-3.47
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-4.46 – -2.61
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
sex [M]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.10
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.42 – 1.82
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.002</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
ldosis
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.54
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.19 – 1.93
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">
12
</td>
</tr>
</table>
<p>de forma que podemos escribir el predictor lineal mediante las expresiones siguientes (atendiendo a los diferentes valores de <code>sex</code>):</p>
<p><span class="math display">\[
log\left(\frac{\widehat{\pi_i}}{1-\widehat{\pi_i}}\right)_{Machos} = -2.37 + 1,54* ldosis_{i}
\]</span></p>
<p><span class="math display">\[
log\left(\frac{\widehat{\pi_i}}{1-\widehat{\pi_i}}\right)_{Hembras} = -3.47 + 1.54* ldosis_{i}
\]</span></p>
<p>donde <span class="math inline">\(\pi_i\)</span> es la probabilidad de muerte de la polilla. Dado que la interceptación es más pequeña para las hembras que para los machos tenemos un indicador de que las hembras son más resistentes que los machos. La pendiente positiva refleja que la probabilidad de muerte aumenta cuando lo hace la dosis.</p>
<p>En términos de los odds ratios:</p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="glmbinomial.html#cb574-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen del predictor lineal</span></span>
<span id="cb574-2"><a href="glmbinomial.html#cb574-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_model</span>(fit.dosis, </span>
<span id="cb574-3"><a href="glmbinomial.html#cb574-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">show.r2 =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Yres
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Odds Ratios
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
(Intercept)
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.01 – 0.07
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
sex [M]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
3.01
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.52 – 6.17
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.002</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
ldosis
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
4.64
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
3.28 – 6.90
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">
12
</td>
</tr>
</table>
<p>podemos ver que el odds ratio de los machos frente a las hembras es 3.01 veces (coeficiente de sexo) superior, y es 4.64 veces mayor (coeficiente de log(dosis)) cuando aumentamos en una unidad el logaritmo de la dosis.</p>
<p>El odds ratio por sexo se obtiene como:
<span class="math display">\[
\frac{\left(\widehat{\pi_i}/(1-\widehat{\pi_i})\right)_{Machos}}{\left(\widehat{\pi_i}/(1-\widehat{\pi_i})\right)_{Hembras}} = \frac{exp(-2.37 + 1,54 * ldosis_{i})}{exp(-3.47 + 1.54 * ldosis_{i})} = exp(3.47 - 2.37) = exp(1.1)
\]</span></p>
<p>mientras que el odds ratio por ldosis, tanto para machos como para hembras, se obtiene como (tomamos los machos):
<span class="math display">\[
\frac{\left(\widehat{\pi_i}/(1-\widehat{\pi_i})\right)_{Machos}}{\left(\widehat{\pi_i}/(1-\widehat{\pi_i})\right)_{Machos}} = \frac{exp(-2.37 + 1,54 * (ldosis_{i}+1))}{exp(-2.37 + 1.54 * ldosis_{i})} = exp(1.54) 
\]</span></p>
<p>La bondad de ajuste de este modelo:</p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="glmbinomial.html#cb575-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(fit.dosis<span class="sc">$</span>deviance,fit.dosis<span class="sc">$</span>df.residual)</span></code></pre></div>
<pre><code>## [1] 0.6623957</code></pre>
<p>muestra que el ajuste obtenido puede considerarse como bueno dado que el p-valor resulta no significativo.</p>
<p>Para verificar el efecto de la dosis por sexo podemos calcular cuál es la dosis necesaria aplicar a cada sexo para conseguir una probabilidad de muerte del 50%, o como habitualmente se conoce con el nombre de dosis letal al 50% (LD50). Para ello basta con sustituir en las ecuaciones anteriores el valor de <span class="math inline">\(\pi_i\)</span> por 0.5 y despejar el valor de ldosis:</p>
<p><span class="math display">\[ldosis50_{Machos} = \frac{2.372}{1.535} = 1.54277 \to dosis50_{Machos} = exp(1.54277) = 4.69 \]</span>
<span class="math display">\[ldosis50_{Hembras} = \frac{3.473}{1.535} = 2.262541 \to dosis50_{Hembras} = exp(1.54277) = 9.61 \]</span></p>
<p>De los resultados obtenidos podemos ver que hay que aplicar el doble de dosis en las hembras para conseguir la misma probabilidad de muerte del 50%.</p>
<p>Para conseguir cualquier otra dosis letal basta con sustituir <span class="math inline">\(\pi_i\)</span> por la correspondiente probabilidad y despejar en las ecuaciones obtenidas, o utilizar el código siguiente para obtener la dosis letal a una probabilidad “prob”:</p>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="glmbinomial.html#cb577-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prob = Probabilidad buscada</span></span>
<span id="cb577-2"><a href="glmbinomial.html#cb577-2" aria-hidden="true" tabindex="-1"></a>predictor <span class="ot">&lt;-</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit)<span class="sc">$</span><span class="fu">linkfun</span>(prob)</span>
<span id="cb577-3"><a href="glmbinomial.html#cb577-3" aria-hidden="true" tabindex="-1"></a>machos <span class="ot">&lt;-</span><span class="fu">exp</span>((predictor<span class="fl">+2.372</span>)<span class="sc">/</span><span class="fl">1.535</span>)</span>
<span id="cb577-4"><a href="glmbinomial.html#cb577-4" aria-hidden="true" tabindex="-1"></a>hembras <span class="ot">&lt;-</span> <span class="fu">exp</span>((predictor<span class="fl">+3.473</span>)<span class="sc">/</span><span class="fl">1.535</span>)</span></code></pre></div>
<p>Utilizamos el código anterior para representar y estudiar las curvas de dosis letales para ambos sexos (machos = azul, hembras = rojo):</p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="glmbinomial.html#cb578-1" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.01</span>)</span>
<span id="cb578-2"><a href="glmbinomial.html#cb578-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Trabajamos con dosis </span></span>
<span id="cb578-3"><a href="glmbinomial.html#cb578-3" aria-hidden="true" tabindex="-1"></a>predictor <span class="ot">&lt;-</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit)<span class="sc">$</span><span class="fu">linkfun</span>(prob)</span>
<span id="cb578-4"><a href="glmbinomial.html#cb578-4" aria-hidden="true" tabindex="-1"></a>machos <span class="ot">&lt;-</span><span class="fu">exp</span>((predictor <span class="sc">+</span> <span class="fl">2.372</span>) <span class="sc">/</span> <span class="fl">1.535</span>)</span>
<span id="cb578-5"><a href="glmbinomial.html#cb578-5" aria-hidden="true" tabindex="-1"></a>hembras <span class="ot">&lt;-</span> <span class="fu">exp</span>((predictor <span class="sc">+</span> <span class="fl">3.473</span>) <span class="sc">/</span> <span class="fl">1.535</span>)</span>
<span id="cb578-6"><a href="glmbinomial.html#cb578-6" aria-hidden="true" tabindex="-1"></a>dosis <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(prob, machos, hembras)</span>
<span id="cb578-7"><a href="glmbinomial.html#cb578-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dosis) <span class="sc">+</span> </span>
<span id="cb578-8"><a href="glmbinomial.html#cb578-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> prob, <span class="at">y =</span> machos), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb578-9"><a href="glmbinomial.html#cb578-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> prob, <span class="at">y =</span> hembras), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb578-10"><a href="glmbinomial.html#cb578-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb578-11"><a href="glmbinomial.html#cb578-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">70</span>,<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb578-12"><a href="glmbinomial.html#cb578-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Probabilidad de muerte&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Dosis&quot;</span>) <span class="sc">+</span> </span>
<span id="cb578-13"><a href="glmbinomial.html#cb578-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() </span></code></pre></div>
<p><img src="libroSTAT_files/figure-html/binom023-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="diagnóstico-3" class="section level2" number="12.5">
<h2><span class="header-section-number">12.5</span> Diagnóstico</h2>
<p>Antes de comenzar el proceso de diagnóstico hay que recordar que en este tipo de modelos tenemos dos tipos de valores ajustados y dos tipos de residuos:</p>
<ul>
<li>Los correspondientes al predictor lineal obtenidos con las estimaciones de los parámetros del modelo.</li>
<li>Los correspondientes a los valores originales que se obtienen al deshacer la transformación de la función de enlace.</li>
</ul>
<p>El diagnóstico de los GLM se basa en los procedimientos gráficos, que vimos en temas anteriores, aplicado a los residuos deviance obtenidos a partir del predictor lineal considerado (<span class="math inline">\(X\widehat{\beta}\)</span>). Tanto para obtener los valores ajustados y residuos del predictor lineal utilizaremos la función <code>fortify</code>. Al resultado de dicha función podemos añadir sin muchos problemas los residuos entre valores originales de la respuesta y predichos. En el caso del modelo de regresión logística el código necesario viene dado por:</p>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="glmbinomial.html#cb579-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sólo hay que sustituir &quot;modelo&quot; por el modelo ajustado a nuestros datos</span></span>
<span id="cb579-2"><a href="glmbinomial.html#cb579-2" aria-hidden="true" tabindex="-1"></a>diagnostico <span class="ot">&lt;-</span> <span class="fu">fortify</span>(<span class="st">&quot;modelo&quot;</span>)</span>
<span id="cb579-3"><a href="glmbinomial.html#cb579-3" aria-hidden="true" tabindex="-1"></a>diagnostico<span class="sc">$</span>fitoriginal <span class="ot">&lt;-</span> <span class="fu">predict.glm</span>(<span class="st">&quot;modelo&quot;</span>, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb579-4"><a href="glmbinomial.html#cb579-4" aria-hidden="true" tabindex="-1"></a>diagnostico<span class="sc">$</span>residoriginal <span class="ot">&lt;-</span> <span class="fu">residuals.glm</span>(<span class="st">&quot;modelo&quot;</span>, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<p>Los gráficos de diagnóstico que vamos a utilizar son:</p>
<ul>
<li>Residuos vs Ajustados (predictor lineal)</li>
<li>Residuos vs variables en el modelo (predictor lineal)</li>
<li>Valores influyentes</li>
</ul>
<div id="ejemplos-15" class="section level3" number="12.5.1">
<h3><span class="header-section-number">12.5.1</span> Ejemplos</h3>
<p>Pasamos a analizar cada uno de los ejemplos.</p>
<div id="kyphosis-2" class="section level4" number="12.5.1.1">
<h4><span class="header-section-number">12.5.1.1</span> Kyphosis</h4>
<p>Obtenemos todas las cantidades de interés del modelo</p>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="glmbinomial.html#cb580-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtención de valores para el diagnóstico</span></span>
<span id="cb580-2"><a href="glmbinomial.html#cb580-2" aria-hidden="true" tabindex="-1"></a>diagnostico <span class="ot">&lt;-</span> <span class="fu">fortify</span>(fit.kyphosis)</span>
<span id="cb580-3"><a href="glmbinomial.html#cb580-3" aria-hidden="true" tabindex="-1"></a>diagnostico<span class="sc">$</span>fitoriginal <span class="ot">&lt;-</span> <span class="fu">predict.glm</span>(fit.kyphosis, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb580-4"><a href="glmbinomial.html#cb580-4" aria-hidden="true" tabindex="-1"></a>diagnostico<span class="sc">$</span>residoriginal <span class="ot">&lt;-</span> <span class="fu">residuals.glm</span>(fit.kyphosis, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<p>Realizamos los gráficos de diagnóstico</p>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="glmbinomial.html#cb581-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Gráfico de residuos vs ajustados (predictor lineal)</span></span>
<span id="cb581-2"><a href="glmbinomial.html#cb581-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diagnostico, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .stdresid)) <span class="sc">+</span></span>
<span id="cb581-3"><a href="glmbinomial.html#cb581-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb581-4"><a href="glmbinomial.html#cb581-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>loess, <span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb581-5"><a href="glmbinomial.html#cb581-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Residuos&quot;</span>)</span></code></pre></div>
<p><img src="libroSTAT_files/figure-html/binom026-1.png" width="672" /></p>
<p>Como se puede observar en el gráfico de ajustados versus residuos la interpretación en este tipo de modelos se hace bastante complicada. Esto es debido a que la variable respuesta sólo toma valores 0 y 1, lo que motiva que el gráfico tenga esa pinta tan extraña. Si valoraros las distancias de Cook obtenidas (<code>diagnostico$.cooksd</code>) podemos ver que no hay ninguna superior a 1, y por tanto no tenemos ninguna observación influyente.</p>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="glmbinomial.html#cb582-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráficos de residuos vs predictoras (preditor lineal)</span></span>
<span id="cb582-2"><a href="glmbinomial.html#cb582-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(fit.kyphosis, <span class="at">type =</span> <span class="st">&quot;resid&quot;</span>,</span>
<span id="cb582-3"><a href="glmbinomial.html#cb582-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.data =</span> <span class="cn">TRUE</span>,</span>
<span id="cb582-4"><a href="glmbinomial.html#cb582-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb582-5"><a href="glmbinomial.html#cb582-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="libroSTAT_files/figure-html/binom027-1.png" width="672" /></p>
<p>En cuanto a los gráficos con respecto a las variables predictoras parece apreciarse ciertas tendencias con respecto a ellas. Este comportamiento parece más evidente con la variable edad donde se ve una parábola indicando la posible existencia de un efecto polinómico de grado 2 con respecto a ella. En las otras dos predictoras el efecto es menos apreciable.</p>
<p>Para solucionar este problema la opción más habitual sería ajustar un nuevo modelo indicando dicha tendencia de grado 2 (modelo polinómico con <code>Age</code>), pero se podría optar también por la inclusión de efectos de suavizado sobre cada una de ellas para evitar esas tendencias observadas. Utilizamos esta última opción y optamos por incluir efectos de suavizado para <code>Age</code> y <code>Start</code> (ambos con tendencias parabólicas) y comparamos con en el modelo sin suavizado.</p>
<p>A pesar de que la respuesta no es numérica pode os utilizar la función <code>gam</code> sin más que identificar el tipo de respuesta y la función de enlace a utilizar. Veamos el ajuste y la comparación entre ambos modelos:</p>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="glmbinomial.html#cb583-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo con suavizado en edad y start</span></span>
<span id="cb583-2"><a href="glmbinomial.html#cb583-2" aria-hidden="true" tabindex="-1"></a>fit.kyphosis.gam <span class="ot">&lt;-</span> <span class="fu">gam</span>(Kyphosis  <span class="sc">~</span> <span class="fu">s</span>(Age, <span class="at">k =</span> <span class="dv">10</span>, <span class="at">m =</span> <span class="dv">2</span>, <span class="at">bs =</span> <span class="st">&quot;ps&quot;</span>)  <span class="sc">+</span> </span>
<span id="cb583-3"><a href="glmbinomial.html#cb583-3" aria-hidden="true" tabindex="-1"></a>                          Number <span class="sc">+</span> </span>
<span id="cb583-4"><a href="glmbinomial.html#cb583-4" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">s</span>(Start, <span class="at">k =</span> <span class="dv">10</span>, <span class="at">m =</span> <span class="dv">2</span>, <span class="at">bs =</span> <span class="st">&quot;ps&quot;</span>),</span>
<span id="cb583-5"><a href="glmbinomial.html#cb583-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit),kyphosisb)</span>
<span id="cb583-6"><a href="glmbinomial.html#cb583-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparamos utilizando el estadístico AIC</span></span>
<span id="cb583-7"><a href="glmbinomial.html#cb583-7" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(fit.kyphosis,fit.kyphosis.gam)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:binom028">
<caption style="caption-side: top; text-align: center;"><span id="tab:binom028">Tabla 12.3: </span> </caption><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">df</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">4&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">69.4</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">6.11</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">62.7</td></tr>
</table>

<p>El menor valor de AIC indica que el modelo con efectos de suavizado es preferible al que no los tiene. Estudiamos con un poco más detalle dicho modelo:</p>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="glmbinomial.html#cb584-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen del predictor lineal</span></span>
<span id="cb584-2"><a href="glmbinomial.html#cb584-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.kyphosis.gam)</span></code></pre></div>
<pre><code>## 
## Family: binomial 
## Link function: logit 
## 
## Formula:
## Kyphosis ~ s(Age, k = 10, m = 2, bs = &quot;ps&quot;) + Number + s(Start, 
##     k = 10, m = 2, bs = &quot;ps&quot;)
## 
## Parametric coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)   
## (Intercept)  -3.6011     1.1482  -3.136  0.00171 **
## Number        0.3333     0.2324   1.434  0.15160   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##            edf Ref.df Chi.sq p-value  
## s(Age)   2.151  2.671  6.345  0.0699 .
## s(Start) 1.956  2.409  9.747  0.0130 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.354   Deviance explained = 39.3%
## UBRE = -0.22572  Scale est. = 1         n = 81</code></pre>
<p>En los efectos paramétricos se comprueba que el efecto asociado con <code>Number</code> no resulta significativo, mientras que en los no paramétricos vemos que el suavizado con edad no resulta significativo al 95%. Construimos todos los posibles modelos y valoramos cual de ellos es el mejor:</p>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb586-1"><a href="glmbinomial.html#cb586-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo con suavizados y number</span></span>
<span id="cb586-2"><a href="glmbinomial.html#cb586-2" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> <span class="fu">gam</span>(Kyphosis  <span class="sc">~</span> <span class="fu">s</span>(Age, <span class="at">k =</span> <span class="dv">10</span>, <span class="at">m =</span> <span class="dv">2</span>, <span class="at">bs =</span> <span class="st">&quot;ps&quot;</span>)  <span class="sc">+</span> </span>
<span id="cb586-3"><a href="glmbinomial.html#cb586-3" aria-hidden="true" tabindex="-1"></a>            Number <span class="sc">+</span> </span>
<span id="cb586-4"><a href="glmbinomial.html#cb586-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">s</span>(Start, <span class="at">k =</span> <span class="dv">10</span>, <span class="at">m =</span> <span class="dv">2</span>, <span class="at">bs =</span> <span class="st">&quot;ps&quot;</span>),</span>
<span id="cb586-5"><a href="glmbinomial.html#cb586-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit),kyphosisb)</span>
<span id="cb586-6"><a href="glmbinomial.html#cb586-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo con suavizados y sin number</span></span>
<span id="cb586-7"><a href="glmbinomial.html#cb586-7" aria-hidden="true" tabindex="-1"></a>M2 <span class="ot">&lt;-</span> <span class="fu">gam</span>(Kyphosis  <span class="sc">~</span> <span class="fu">s</span>(Age, <span class="at">k =</span> <span class="dv">10</span>, <span class="at">m =</span> <span class="dv">2</span>, <span class="at">bs =</span> <span class="st">&quot;ps&quot;</span>) <span class="sc">+</span> </span>
<span id="cb586-8"><a href="glmbinomial.html#cb586-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">s</span>(Start, <span class="at">k =</span> <span class="dv">10</span>, <span class="at">m =</span> <span class="dv">2</span>, <span class="at">bs =</span> <span class="st">&quot;ps&quot;</span>),</span>
<span id="cb586-9"><a href="glmbinomial.html#cb586-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit),kyphosisb)</span>
<span id="cb586-10"><a href="glmbinomial.html#cb586-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo con suavizados con Start unicamente</span></span>
<span id="cb586-11"><a href="glmbinomial.html#cb586-11" aria-hidden="true" tabindex="-1"></a>M3 <span class="ot">&lt;-</span> <span class="fu">gam</span>(Kyphosis  <span class="sc">~</span> <span class="fu">s</span>(Start, <span class="at">k =</span> <span class="dv">10</span>, <span class="at">m =</span> <span class="dv">2</span>, <span class="at">bs =</span> <span class="st">&quot;ps&quot;</span>),</span>
<span id="cb586-12"><a href="glmbinomial.html#cb586-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> logit),kyphosisb)</span>
<span id="cb586-13"><a href="glmbinomial.html#cb586-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Valores de AIC</span></span>
<span id="cb586-14"><a href="glmbinomial.html#cb586-14" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(M1,M2,M3)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:binom030">
<caption style="caption-side: top; text-align: center;"><span id="tab:binom030">Tabla 12.4: </span> </caption><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">df</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">AIC</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">6.11</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">62.7</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">5.24</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">63&nbsp;&nbsp;</td></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">3.07</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">68.3</td></tr>
</table>

<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="glmbinomial.html#cb587-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Valores de GCV</span></span>
<span id="cb587-2"><a href="glmbinomial.html#cb587-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(M1<span class="sc">$</span>gcv.ubre,M2<span class="sc">$</span>gcv.ubre,M3<span class="sc">$</span>gcv.ubre)</span></code></pre></div>
<pre><code>##     GCV.Cp     GCV.Cp     GCV.Cp 
## -0.2257187 -0.2223853 -0.1562664</code></pre>
<p>El menor valor de AIC corresponde al modelo con los dos suavizados y la variable <code>Number</code>. Hay que tener en cuenta que las significatividades que parecen en las tablas son aproximaciones asintóticas, y por tanto siempre se deben tomar con cautela y proceder con otro tipo de comparación. El estadístico GCV también proporciona la misma conclusión.</p>
<p>Por tanto, el modelo final ajustado viene dado por:</p>
<p><span class="math display">\[log\left(\frac{\pi_i}{1-\pi_i}\right) = -3.60 + 0.33 * Number_i + s(Age_i) + s(Start_i)\]</span></p>
<p>Realizamos el diagnóstico del modelo de suavizado utilizando los procedimientos vistos en dicha unidad.</p>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="glmbinomial.html#cb589-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráficos de diagnóstico</span></span>
<span id="cb589-2"><a href="glmbinomial.html#cb589-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gam.check</span>(fit.kyphosis.gam)</span></code></pre></div>
<p><img src="libroSTAT_files/figure-html/binom031-1.png" width="672" /></p>
<pre><code>## 
## Method: UBRE   Optimizer: outer newton
## full convergence after 4 iterations.
## Gradient range [-5.641377e-09,6.154328e-08]
## (score -0.2257187 &amp; scale 1).
## Hessian positive definite, eigenvalue range [0.007746516,0.01021528].
## Model rank =  20 / 20 
## 
## Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
## indicate that k is too low, especially if edf is close to k&#39;.
## 
##            k&#39;  edf k-index p-value
## s(Age)   9.00 2.15    1.11    0.86
## s(Start) 9.00 1.96    1.14    0.92</code></pre>
<p>Ningún p-valor resulta significativo indicando que el suavizado utilizado es adecuado. Además, los gráficos de diagnóstico no reportan ninguna incidencia.</p>
</div>
<div id="dosis---respuesta" class="section level4" number="12.5.1.2">
<h4><span class="header-section-number">12.5.1.2</span> Dosis - respuesta</h4>
<p>Realizamos ahora el diagnóstico para el modelo de dosis-respuesta a partir del modelo sin interacción obtenido en el apartado de selección del modelo. Obtenemos las cantidades de interés y realizamos los gráficos correspondientes.</p>
<p>Obtenemos todas las cantidades de interés del modelo</p>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="glmbinomial.html#cb591-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtención de valores para el diagnóstico</span></span>
<span id="cb591-2"><a href="glmbinomial.html#cb591-2" aria-hidden="true" tabindex="-1"></a>diagnostico <span class="ot">&lt;-</span> <span class="fu">fortify</span>(fit.dosis)</span>
<span id="cb591-3"><a href="glmbinomial.html#cb591-3" aria-hidden="true" tabindex="-1"></a>diagnostico<span class="sc">$</span>fitoriginal <span class="ot">&lt;-</span> <span class="fu">predict.glm</span>(fit.dosis, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb591-4"><a href="glmbinomial.html#cb591-4" aria-hidden="true" tabindex="-1"></a>diagnostico<span class="sc">$</span>residoriginal <span class="ot">&lt;-</span> <span class="fu">residuals.glm</span>(fit.dosis, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<p>Realizamos el gráfico de residuos versus ajustados identificando por el factor:</p>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="glmbinomial.html#cb592-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Gráfico de residuos vs ajustados (predictor lineal)</span></span>
<span id="cb592-2"><a href="glmbinomial.html#cb592-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diagnostico, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .stdresid, <span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb592-3"><a href="glmbinomial.html#cb592-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb592-4"><a href="glmbinomial.html#cb592-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Ajustados&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Residuos&quot;</span>)</span></code></pre></div>
<p><img src="libroSTAT_files/figure-html/binom033-1.png" width="672" /></p>
<p>En este caso no hemos ajustado las tendencias, ya que dado el tamaño de muestra tan pequeño en cada uno de los grupos, los resultados podrían mostrar tendencias ficticias que nos podrían hacer dudar de la validez del modelo. En este caso no se puede afirmar que exista ningún tipo de tendencia destacable. Tampoco se registra ninguna observación influyente.</p>
<p>En los gráficos de residuos versus predictoras ocurre algo similar, ya que el número de observaciones es tan bajo que las posibles tendencias observadas no implican una modificación del modelo planteado. Dado el número tan bajo de observaciones el planteamiento de modelos con suavizado sobre dosis no resulta una opción.</p>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb593-1"><a href="glmbinomial.html#cb593-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráficos de residuos vs predictoras (preditor lineal)</span></span>
<span id="cb593-2"><a href="glmbinomial.html#cb593-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(fit.dosis, <span class="at">type =</span> <span class="st">&quot;resid&quot;</span>,</span>
<span id="cb593-3"><a href="glmbinomial.html#cb593-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">show.data =</span> <span class="cn">TRUE</span>,</span>
<span id="cb593-4"><a href="glmbinomial.html#cb593-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb593-5"><a href="glmbinomial.html#cb593-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="libroSTAT_files/figure-html/binom034-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="predicción-4" class="section level2" number="12.6">
<h2><span class="header-section-number">12.6</span> Predicción</h2>
<p>La predicción en este tipo de modelos se divide en dos fases: i) predicción del predictor lineal, y ii) predicción de la respuesta, aunque evidentemente la más interesante es la correspondiente a la respuesta.</p>
<p>Sin embargo, cuando la respuesta viene individualizada, la predicción obtenida es un valor comprendido entre 0 y 1, con lo que hay que definir una regla para clasificar finalmente al sujeto con un 1 o un 0, identificando el éxito o el fracaso. En esta situación se toma la regla:</p>
<ul>
<li>si la predicción es mayor o igual a 0.5 asignamos un éxito como resultado de la predicción</li>
<li>si la predicción es menor a 0.5 asignamos un fracaso como resultado de la predicción</li>
</ul>
<p>El resultado de la predicción es una tabla de doble entrada donde comparamos los valores observados frente a los predichos calculados con la regla anterior. En esta situación estamos interesados en el porcentaje de observaciones que son correctamente clasificadas como éxitos o fracasos.</p>
<p>Este problema no aparece cuando tenemos datos agrupados ya que la variable respuesta ya es un valor entre 0 y 1, ya que modelizamos directamente la probabilidad de éxito.</p>
<p>En los modelos de suavizado utilizaremos la función <code>gam.predict</code> para conseguir las predicciones.</p>
<div id="ejemplos-16" class="section level3" number="12.6.1">
<h3><span class="header-section-number">12.6.1</span> Ejemplos</h3>
<p>A continuación, presentamos los procedimientos para obtener y representar la predicción de los modelos obtenidos en apartados anteriores.</p>
<div id="kyphosis-3" class="section level4" number="12.6.1.1">
<h4><span class="header-section-number">12.6.1.1</span> Kyphosis</h4>
<p>Dado que en este caso tenemos datos individualizamos, en primer lugar calculamos la predicción de la respuesta y utilizamos la regla de clasificación presentada anteriormente, para obtener el porcentaje de clasificación correcta.</p>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="glmbinomial.html#cb594-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtención de predicción de la respuesta</span></span>
<span id="cb594-2"><a href="glmbinomial.html#cb594-2" aria-hidden="true" tabindex="-1"></a>prediccion <span class="ot">&lt;-</span> <span class="fu">predict.gam</span>(fit.kyphosis.gam, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb594-3"><a href="glmbinomial.html#cb594-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Clasificacmos a cada sujeto como éxito o fracaso</span></span>
<span id="cb594-4"><a href="glmbinomial.html#cb594-4" aria-hidden="true" tabindex="-1"></a>clasificado <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">*</span>(prediccion<span class="sc">&gt;=</span><span class="fl">0.5</span>)</span>
<span id="cb594-5"><a href="glmbinomial.html#cb594-5" aria-hidden="true" tabindex="-1"></a>tabla <span class="ot">&lt;-</span> <span class="fu">table</span>(kyphosis<span class="sc">$</span>Kyphosis,clasificado)</span>
<span id="cb594-6"><a href="glmbinomial.html#cb594-6" aria-hidden="true" tabindex="-1"></a>tabla</span></code></pre></div>
<pre><code>##          clasificado
##            0  1
##   absent  60  4
##   present  7 10</code></pre>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="glmbinomial.html#cb596-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Porcentaje de clasificación correcta</span></span>
<span id="cb596-2"><a href="glmbinomial.html#cb596-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">sum</span>(<span class="fu">diag</span>(tabla))<span class="sc">/</span><span class="fu">sum</span>(tabla),<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 86.42</code></pre>
<p>Tenemos un 86.42% de clasificar correctamente a un individuo como éxito o fracaso en función de las variables predictoras consideradas. El modelo construido tiene alta capacidad predictiva ya que identifica bastante bien a los sujetos clasificados como éxitos y como fracasos.</p>
<p>Estudiamos ahora los efectos marginales individuales de cada efecto presente en el modelo para valorar como influyen en la probabilidad de éxito, es decir, probabilidad de sufrir una malformación.</p>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="glmbinomial.html#cb598-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráficos marginales</span></span>
<span id="cb598-2"><a href="glmbinomial.html#cb598-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(fit.kyphosis.gam, <span class="st">&quot;pred&quot;</span>)</span></code></pre></div>
<pre><code>## $Age</code></pre>
<p><img src="libroSTAT_files/figure-html/binom036-1.png" width="672" /></p>
<pre><code>## 
## $Number</code></pre>
<p><img src="libroSTAT_files/figure-html/binom036-2.png" width="672" /></p>
<pre><code>## 
## $Start</code></pre>
<p><img src="libroSTAT_files/figure-html/binom036-3.png" width="672" /></p>
<p>Se observa la parábola que describe la variable <code>Age</code>, la función creciente con <code>Number</code> y la función decreciente con <code>Start</code>. En conclusión, la probabilidad de malformación:</p>
<ul>
<li>es más alta en valores de <code>Age</code> próximos a los 100 meses (probabilidad superior a 0.2).</li>
<li>crece conforme aumenta el número de vértebras involucradas hasta superar el 0.6 con 10 vértebras.</li>
<li>disminuye con la primera vértebra operada (si es a partir de la quinta) hasta hacerse prácticamente cero si empezamos en la vértebra 20.</li>
</ul>
<p>Construimos ahora los gráficos conjuntos para las tres predictoras mediante la creación de escenarios. Concretamente seleccionamos valores para <code>Start</code> y <code>Age</code>:</p>
<ul>
<li>Valores Start: 1, 5, 10, 15.</li>
<li>Valores Age: 0, 50, 100, 150, 200, 250, 300</li>
</ul>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="glmbinomial.html#cb602-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráficos marginales</span></span>
<span id="cb602-2"><a href="glmbinomial.html#cb602-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(fit.kyphosis.gam, <span class="st">&quot;pred&quot;</span>, </span>
<span id="cb602-3"><a href="glmbinomial.html#cb602-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">terms =</span><span class="fu">c</span>(<span class="st">&quot;Number&quot;</span>, <span class="st">&quot;Age [0, 50, 100, 150, 200, 250, 300]&quot;</span>, <span class="st">&quot;Start [1,5,10,15]&quot;</span>),</span>
<span id="cb602-4"><a href="glmbinomial.html#cb602-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">ci.lvl =</span> <span class="cn">NA</span>)</span></code></pre></div>
<p><img src="libroSTAT_files/figure-html/binom037-1.png" width="672" /></p>
<p>Podemos ver el efecto de los escenarios con <code>Number</code> para predecir la probabilidad de malformación. No se aprecian muchas diferencias entre los perfiles de predicción para <code>Start</code> en los tres primeros niveles considerados, donde la probabilidad de malformación es muy similar, pero si se aprecian cambios cuando <code>Start = 15</code>. Esto implica directamente que cuando dicha variable toma valores más grandes la probabilidad de malformación disminuye drásticamente.</p>
</div>
<div id="dosis-respuesta-2" class="section level4" number="12.6.1.2">
<h4><span class="header-section-number">12.6.1.2</span> Dosis-respuesta</h4>
<p>Dado que los datos están en formato agrupado obtenemos los gráficos de predicción asociados a los efectos del modelo:</p>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="glmbinomial.html#cb603-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(fit.dosis,<span class="st">&quot;pred&quot;</span>,</span>
<span id="cb603-2"><a href="glmbinomial.html#cb603-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">&quot;ldosis&quot;</span>,<span class="st">&quot;sex&quot;</span>),</span>
<span id="cb603-3"><a href="glmbinomial.html#cb603-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">&quot;Porcentaje de insectos muertos&quot;</span>,</span>
<span id="cb603-4"><a href="glmbinomial.html#cb603-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title  =</span> <span class="fu">c</span>(<span class="st">&quot;Log(dosis)&quot;</span>,<span class="st">&quot;&quot;</span>))</span></code></pre></div>
<p><img src="libroSTAT_files/figure-html/binom038-1.png" width="672" /></p>
<p>En los perfiles obtenidos se aprecia claramente el paralelismo entre ambos sexos, mostrando que las hembras son más resistentes (probabilidad de morir más baja) para todos los niveles de dosis considerados, y que la probabilidad de morir aumenta con la dosis suministrada.</p>
</div>
</div>
</div>
<div id="ejercicios-4" class="section level2" number="12.7">
<h2><span class="header-section-number">12.7</span> Ejercicios</h2>
<p><strong>Ejercicio 1.</strong> En un experimento se sometió a cierto número de cucarachas (<code>number</code>) a cinco horas de exposición a disulfato de carbono gaseoso a varias concentraciones. Se pretendía investigar la relación existente entre la dosis (<code>dose</code>) de disulfato administrada y la resistencia de los insectos (<code>dead</code>); si existe tal relación, determinar la dosis a la cual es posible garantizar el exterminio del 50% de los insectos.</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="glmbinomial.html#cb604-1" aria-hidden="true" tabindex="-1"></a>ejercicio01 <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://goo.gl/E2MlSZ&quot;</span>, <span class="at">col_types =</span> <span class="st">&quot;dii&quot;</span>)</span>
<span id="cb604-2"><a href="glmbinomial.html#cb604-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculamos los vivos para el ajuste de modelos</span></span>
<span id="cb604-3"><a href="glmbinomial.html#cb604-3" aria-hidden="true" tabindex="-1"></a>ejercicio01 <span class="ot">=</span> ejercicio01 <span class="sc">%&gt;%</span> </span>
<span id="cb604-4"><a href="glmbinomial.html#cb604-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alive =</span> number <span class="sc">-</span> dead)</span></code></pre></div>
<p><strong>Ejercicio 2.</strong> Se realiza un experimento in vitro para estimar el número de anteras embriogénicas de las especies de plantas Datura innoxia Mill bajo dos condiciones experimentales. El primer tratamiento consiste en almacenar a 3° C durante 48 horas, y el segundo consiste en un control donde no se aplica ningún tratamiento. Además se considera una variable que representa los tres valores de fuerza de centrifugación. Las variables registradas son <code>total</code>, <code>embryogenic</code>, <code>storage</code>, <code>centrifuge</code>. Es de interés en el análisis investigar si efectivamente se demostraba un mayor número de anteras para las diferentes condiciones experimentales.</p>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="glmbinomial.html#cb605-1" aria-hidden="true" tabindex="-1"></a>ejercicio02 <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://goo.gl/6P3zRr&quot;</span>, <span class="at">col_types =</span> <span class="st">&quot;iici&quot;</span>)</span>
<span id="cb605-2"><a href="glmbinomial.html#cb605-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Recodificación del factor y variable de no embryogenic</span></span>
<span id="cb605-3"><a href="glmbinomial.html#cb605-3" aria-hidden="true" tabindex="-1"></a>ejercicio02 <span class="ot">=</span> ejercicio02 <span class="sc">%&gt;%</span></span>
<span id="cb605-4"><a href="glmbinomial.html#cb605-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">storage=</span><span class="fu">fct_recode</span>(storage,<span class="st">&quot;Control&quot;</span> <span class="ot">=</span> <span class="st">&quot;1&quot;</span>,<span class="st">&quot;treatment&quot;</span> <span class="ot">=</span> <span class="st">&quot;2&quot;</span>),</span>
<span id="cb605-5"><a href="glmbinomial.html#cb605-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">nembrig =</span> total <span class="sc">-</span> embryogenic)</span></code></pre></div>
<p><strong>Ejercicio 3.</strong> Se realiza un ensayo clínico para determinar en un grupo de personas mayores su estado psiquiátrico. Para cada sujeto se realiza un análisis completo y se clasifica cada uno en función de si muestra rasgos de senilidad (<code>senility</code>) (calificados como 1) o no (calificados como 0). Por otro lado se les pasa el test de escala de inteligencia de adultos (<code>score</code>) para saber si la puntuación obtenida puede ser un indicador de si la persona tiene rasgos de senilidad o no.</p>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="glmbinomial.html#cb606-1" aria-hidden="true" tabindex="-1"></a>ejercicio03 <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://goo.gl/6E8fhd&quot;</span>, <span class="at">col_types =</span> <span class="st">&quot;ic&quot;</span>)</span>
<span id="cb606-2"><a href="glmbinomial.html#cb606-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertimos la respuesta para el ajuste de modelos</span></span>
<span id="cb606-3"><a href="glmbinomial.html#cb606-3" aria-hidden="true" tabindex="-1"></a>ejercicio03 <span class="ot">=</span> ejercicio03 <span class="sc">%&gt;%</span> </span>
<span id="cb606-4"><a href="glmbinomial.html#cb606-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">senility =</span> <span class="dv">1</span><span class="sc">*</span>(senility<span class="sc">==</span><span class="dv">1</span>))</span></code></pre></div>
<p><strong>Ejercicio 4.</strong> Se realiza un estudio para conocer que el impacto de la bomba de hiroshima en al aparición de caso de leucemia. Para ello se registro para todos los sujetos que presentaron algún tipo de cáncer el grado de radiación al que fue sometida la persona. Las variables que aparecen son los conteos del número de casos de leucemia (<code>leukemia</code>) y de otros tipos de cáncer (<code>other</code>) para los diferentes niveles de radiación (<code>radiation</code>). Se contabilizan también el número total de casos de cáncer registrados (<code>total</code>). Es de interés en el análisis investigar la influencia del grado de radiación en la aparición de un mayor número de casos de leucemia.</p>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="glmbinomial.html#cb607-1" aria-hidden="true" tabindex="-1"></a>ejercicio04 <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://goo.gl/ZDIWVC&quot;</span>, <span class="at">col_types =</span> <span class="st">&quot;ciii&quot;</span>)</span></code></pre></div>
<p><strong>Ejercicio 5.</strong> La Oficina Europea de Patentes puede proteger una patente de la competencia durante un cierto período de tiempo. La Oficina de Patentes tiene la tarea de examinar las invenciones y declarar patentes si se cumplen ciertos requisitos previos. El requisito más importante es que la invención sea algo realmente nuevo. Con el fin de analizar las objeciones contra las patentes, se recopiló un conjunto de datos con 4,866 patentes de los sectores biotecnología / farmacia y semiconductor / computadora. Las variables inclinadas son: <code>opp</code> = oposición de patente; <code>biopharm</code> = Patente del sector biotecnológico / farmacéutico; <code>ustwin</code> = existe la patente gemela estadounidense; <code>patus</code> = titular de la patente de los Estados Unidos; <code>patgsgr</code> = titular de la patente de Alemania, Suiza o Gran Bretaña; año = Año de concesión; <code>ncit</code> = Número de citas de la patente; <code>ncountry</code> = Número de estados designados para la patente; <code>nclaims</code> = Número de declaraciones. ¿Cómo afecta cada una de las variables consideradas en la posible objeción a una patente?</p>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="glmbinomial.html#cb608-1" aria-hidden="true" tabindex="-1"></a>ejercicio05 <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://goo.gl/2EygLk&quot;</span>, <span class="at">col_types =</span> <span class="st">&quot;ccccciiii&quot;</span>)</span>
<span id="cb608-2"><a href="glmbinomial.html#cb608-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Recodificación de factores</span></span>
<span id="cb608-3"><a href="glmbinomial.html#cb608-3" aria-hidden="true" tabindex="-1"></a>ejercicio05 <span class="ot">=</span> ejercicio05 <span class="sc">%&gt;%</span> </span>
<span id="cb608-4"><a href="glmbinomial.html#cb608-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">opp =</span> <span class="fu">fct_recode</span>(opp,<span class="st">&quot;yes&quot;</span> <span class="ot">=</span> <span class="st">&quot;1&quot;</span>,<span class="st">&quot;no&quot;</span> <span class="ot">=</span> <span class="st">&quot;0&quot;</span>), </span>
<span id="cb608-5"><a href="glmbinomial.html#cb608-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">biopharm=</span><span class="fu">fct_recode</span>(biopharm,<span class="st">&quot;yes&quot;</span> <span class="ot">=</span> <span class="st">&quot;1&quot;</span>,<span class="st">&quot;no&quot;</span> <span class="ot">=</span><span class="st">&quot;0&quot;</span>),</span>
<span id="cb608-6"><a href="glmbinomial.html#cb608-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">ustwin=</span><span class="fu">fct_recode</span>(ustwin,<span class="st">&quot;yes&quot;</span> <span class="ot">=</span> <span class="st">&quot;1&quot;</span>,<span class="st">&quot;no&quot;</span> <span class="ot">=</span> <span class="st">&quot;0&quot;</span>),</span>
<span id="cb608-7"><a href="glmbinomial.html#cb608-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">patus=</span><span class="fu">fct_recode</span>(patus,<span class="st">&quot;yes&quot;</span> <span class="ot">=</span> <span class="st">&quot;1&quot;</span>,<span class="st">&quot;no&quot;</span> <span class="ot">=</span> <span class="st">&quot;0&quot;</span>),</span>
<span id="cb608-8"><a href="glmbinomial.html#cb608-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">patgsgr=</span><span class="fu">fct_recode</span>(patgsgr,<span class="st">&quot;yes&quot;</span> <span class="ot">=</span> <span class="st">&quot;1&quot;</span>,<span class="st">&quot;no&quot;</span> <span class="ot">=</span> <span class="st">&quot;0&quot;</span>))</span></code></pre></div>
<p><strong>Ejercicio 6.</strong> Los datos siguientes describen los patrones de comportamiento en el consumo de drogas psicotrópicas en una muestra de individuos del Oeste de Londres. Los investigadores se plantean las preguntas siguientes:</p>
<ul>
<li>¿Hay diferencias por <code>sexo</code> en el consumo de drogas? ¿Cómo influye la <code>edad</code> para explicar el consumo de psicotrópicos? ¿La edad influye igual en hombres y en mujeres?</li>
<li>Obtén la expresión y el valor de las predicciones sobre el consumo de psicotrópicos en hombres y en mujeres de 17 y 52 años con el modelo ajustado.</li>
</ul>
<p>Las variables <code>usa</code> y <code>nousa</code> contienen la información sobre el uso de drogas psicotrópicas.</p>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="glmbinomial.html#cb609-1" aria-hidden="true" tabindex="-1"></a>sexo <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;H&quot;</span>,<span class="dv">4</span>),<span class="fu">rep</span>(<span class="st">&quot;M&quot;</span>,<span class="dv">4</span>))</span>
<span id="cb609-2"><a href="glmbinomial.html#cb609-2" aria-hidden="true" tabindex="-1"></a>edad <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;16-29&quot;</span>,<span class="st">&quot;30-44&quot;</span>,<span class="st">&quot;45-64&quot;</span>,<span class="st">&quot;65-74&quot;</span>,<span class="st">&quot;16-29&quot;</span>,<span class="st">&quot;30-44&quot;</span>,<span class="st">&quot;45-64&quot;</span>,<span class="st">&quot;65-74&quot;</span>)</span>
<span id="cb609-3"><a href="glmbinomial.html#cb609-3" aria-hidden="true" tabindex="-1"></a>usa <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">32</span>,<span class="dv">70</span>,<span class="dv">43</span>,<span class="dv">46</span>,<span class="dv">89</span>,<span class="dv">169</span>,<span class="dv">51</span>)</span>
<span id="cb609-4"><a href="glmbinomial.html#cb609-4" aria-hidden="true" tabindex="-1"></a>nousa <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">683</span>,<span class="dv">596</span>,<span class="dv">705</span>,<span class="dv">295</span>,<span class="dv">738</span>,<span class="dv">700</span>,<span class="dv">847</span>,<span class="dv">196</span>)</span>
<span id="cb609-5"><a href="glmbinomial.html#cb609-5" aria-hidden="true" tabindex="-1"></a>ejercicio06 <span class="ot">=</span> <span class="fu">data.frame</span>(sexo, edad, usa, nousa)</span></code></pre></div>
<p><strong>Ejercicio 7.</strong> Se desea estudiar la sensibilidad de un test basado en el diagnóstico de la tuberculosis a través de una prueba basada en rayos X. la información registrdas viene agrupada para las variables <code>tuberculosis</code>, <code>total</code> y <code>rayosx</code>. En las dos primeras se registran los positivos y negativos detectados por rayox para los enfermos de tuberculosis y para todos los que se realziaron las pruebas.</p>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="glmbinomial.html#cb610-1" aria-hidden="true" tabindex="-1"></a>tuberculosis <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">22</span>,<span class="dv">8</span>)</span>
<span id="cb610-2"><a href="glmbinomial.html#cb610-2" aria-hidden="true" tabindex="-1"></a>total <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">51</span>,<span class="dv">1739</span>)</span>
<span id="cb610-3"><a href="glmbinomial.html#cb610-3" aria-hidden="true" tabindex="-1"></a>rayosx <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Positivo&quot;</span>,<span class="st">&quot;Negativo&quot;</span>)</span>
<span id="cb610-4"><a href="glmbinomial.html#cb610-4" aria-hidden="true" tabindex="-1"></a>ejercicio07 <span class="ot">=</span> <span class="fu">data.frame</span>(tuberculosis, total, rayosx)</span></code></pre></div>
<p><strong>Ejercicio 8.</strong> En el Hospital de Yale-New Heaven, en Connecticut, se llevó a cabo un estudio para investigar la relación entre los nacimientos prematuros (el niño nazca antes de 37 semanas de gestación o su peso sea inferior a 2500 g.) y la edad de la madre. La población de estudio consistió en 175 madres de niños nacidos únicos y prematuros, y 303 madres de niños no prematuros. Los datos agrupados en función de la edad de la madre se presentan a continuación. ¿Hay alguna relación entre la edad de la madre y el hecho de que un niño nazca prematuro? ¿Cuál es el grupo de edad con mayor riesgo?</p>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="glmbinomial.html#cb611-1" aria-hidden="true" tabindex="-1"></a>edad <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;14-17&quot;</span>,<span class="st">&quot;18-19&quot;</span>,<span class="st">&quot;20-24&quot;</span>,<span class="st">&quot;25-29&quot;</span>,<span class="st">&quot;+30&quot;</span>)</span>
<span id="cb611-2"><a href="glmbinomial.html#cb611-2" aria-hidden="true" tabindex="-1"></a>casos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">22</span>,<span class="dv">47</span>,<span class="dv">56</span>,<span class="dv">35</span>)</span>
<span id="cb611-3"><a href="glmbinomial.html#cb611-3" aria-hidden="true" tabindex="-1"></a>controles <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">25</span>,<span class="dv">62</span>,<span class="dv">122</span>,<span class="dv">18</span>)</span>
<span id="cb611-4"><a href="glmbinomial.html#cb611-4" aria-hidden="true" tabindex="-1"></a>ejercicio08 <span class="ot">=</span> <span class="fu">data.frame</span>(edad, casos, controles)</span></code></pre></div>
<p><strong>Ejercicio 9.</strong> En el banco de datos siguiente se presentan los resultados de una encuesta realizada en 1998. A cada sujeto de una muestra de 300 adultos se le pidió que opinara sobre qué política consideraba adecuada implantar respecto al uso de tabaco en lugares públicos. Las opciones planteadas son:</p>
<ul>
<li>Opción 1: Sin restricciones</li>
<li>Opción 2: Fumar sólo en áreas exclusivas</li>
<li>Opción 3: No fumar nunca</li>
<li>Opción 4: No opina</li>
</ul>
<p>¿Hay alguna relación entre la actitud frente al tabaco y el nivel de estudios?</p>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="glmbinomial.html#cb612-1" aria-hidden="true" tabindex="-1"></a>nivel <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Est. Superiores&quot;</span>, <span class="st">&quot;Secundaria&quot;</span>, <span class="st">&quot;Primaria&quot;</span>)</span>
<span id="cb612-2"><a href="glmbinomial.html#cb612-2" aria-hidden="true" tabindex="-1"></a>opt1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">15</span>,<span class="dv">15</span>)</span>
<span id="cb612-3"><a href="glmbinomial.html#cb612-3" aria-hidden="true" tabindex="-1"></a>opt2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">44</span>,<span class="dv">100</span>,<span class="dv">40</span>)</span>
<span id="cb612-4"><a href="glmbinomial.html#cb612-4" aria-hidden="true" tabindex="-1"></a>opt3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">23</span>,<span class="dv">30</span>,<span class="dv">10</span>)</span>
<span id="cb612-5"><a href="glmbinomial.html#cb612-5" aria-hidden="true" tabindex="-1"></a>opt4 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">10</span>)</span>
<span id="cb612-6"><a href="glmbinomial.html#cb612-6" aria-hidden="true" tabindex="-1"></a>total <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">75</span>,<span class="dv">150</span>,<span class="dv">75</span>)</span>
<span id="cb612-7"><a href="glmbinomial.html#cb612-7" aria-hidden="true" tabindex="-1"></a>ejercicio09 <span class="ot">=</span> <span class="fu">data.frame</span>(nivel, opt1, opt2, opt3, opt4, total)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="glm.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="glmpoisson.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["libroSTAT.pdf", "libroSTAT.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
